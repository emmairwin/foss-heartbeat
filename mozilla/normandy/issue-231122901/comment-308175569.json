{"body": "> @Osmose can you give this another spin? I've got addon installs working in my patched console log action now.\r\n\r\nI don't get the unsupported value type issue any longer. Instead, I now get this:\r\n\r\n```\r\n1497371487118\textensions.shield-recipe-client.recipe-runner\tERROR\tCould not execute recipe console lognteststsasdasas:: Error: Permission denied to access property \"then\" (resource://shield-recipe-client/lib/ActionSandboxManager.jsm:81:13) JS Stack trace: runAsyncCallback@ActionSandboxManager.jsm:81:13\r\n```\r\n\r\nWhich makes sense, since you're returning native chrome Promises to the sandbox, which doesn't have access to attributes like `then`. If you wrap your functions in `wrapAsync` ([see this example](https://github.com/mozilla/normandy/pull/778#pullrequestreview-41923535)), that should resolve this last issue.", "body_text": "@Osmose can you give this another spin? I've got addon installs working in my patched console log action now.\n\nI don't get the unsupported value type issue any longer. Instead, I now get this:\n1497371487118\textensions.shield-recipe-client.recipe-runner\tERROR\tCould not execute recipe console lognteststsasdasas:: Error: Permission denied to access property \"then\" (resource://shield-recipe-client/lib/ActionSandboxManager.jsm:81:13) JS Stack trace: runAsyncCallback@ActionSandboxManager.jsm:81:13\n\nWhich makes sense, since you're returning native chrome Promises to the sandbox, which doesn't have access to attributes like then. If you wrap your functions in wrapAsync (see this example), that should resolve this last issue.", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/308175569", "created_at": "2017-06-13T16:37:17Z", "author_association": "MEMBER", "html_url": "https://github.com/mozilla/normandy/pull/778#issuecomment-308175569", "updated_at": "2017-06-13T16:37:17Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "body_html": "<blockquote>\n<p><a class=\"user-mention\" href=\"https://github.com/osmose\">@Osmose</a> can you give this another spin? I've got addon installs working in my patched console log action now.</p>\n</blockquote>\n<p>I don't get the unsupported value type issue any longer. Instead, I now get this:</p>\n<pre><code>1497371487118\textensions.shield-recipe-client.recipe-runner\tERROR\tCould not execute recipe console lognteststsasdasas:: Error: Permission denied to access property \"then\" (resource://shield-recipe-client/lib/ActionSandboxManager.jsm:81:13) JS Stack trace: runAsyncCallback@ActionSandboxManager.jsm:81:13\n</code></pre>\n<p>Which makes sense, since you're returning native chrome Promises to the sandbox, which doesn't have access to attributes like <code>then</code>. If you wrap your functions in <code>wrapAsync</code> (<a href=\"https://github.com/mozilla/normandy/pull/778#pullrequestreview-41923535\">see this example</a>), that should resolve this last issue.</p>", "id": 308175569, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/778"}