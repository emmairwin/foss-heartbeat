{"original_position": 25, "diff_hunk": "@@ -156,6 +156,68 @@ this.NormandyDriver = function(sandboxManager) {\n       sandboxManager.removeHold(`setTimeout-${token}`);\n     },\n \n+    /*\n+     * Return a promise that resolves to an Addon ID if installation is successful.\n+     */\n+    installAddon(url) {\n+        /* Install an addon.  Note that the AddonManager can only handle\n+         * file:// and downloadable URLs.\n+         */\n+\n+      var installObjectCallback = (installObject, resolve, reject) => {\n+        installObject.install();\n+        installObject.addListener({\n+          onInstallEnded: (addonInstall, addon) => {\n+            let addonId = addon.id;\n+            resolve(addonId);\n+          },\n+          onInstallFailed: (addonInstall) => {\n+            reject(`AddonInstall error code: [${addonInstall.error}]`);\n+          },\n+        });\n+      };\n+\n+      function installObjectPromise(installObject) {", "body_text": "All this does is wrap installObjectCallback, which seems to have no other callers. Just put the contents of installObjectCallback straight into the promise function in here, then you don't need to pass reject/resolve around, either.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/778", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/119477765", "created_at": "2017-05-31T21:24:51Z", "author_association": "CONTRIBUTOR", "body": "All this does is wrap `installObjectCallback`, which seems to have no other callers. Just put the contents of `installObjectCallback` straight into the promise function in here, then you don't need to pass reject/resolve around, either.", "updated_at": "2017-06-15T19:56:17Z", "html_url": "https://github.com/mozilla/normandy/pull/778#discussion_r119477765", "pull_request_review_id": 41360860, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/119477765"}, "html": {"href": "https://github.com/mozilla/normandy/pull/778#discussion_r119477765"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/778"}}, "commit_id": "dbb2b5aba2dd9803c76a77a0dae01a837d9bd9fe", "user": {"following_url": "https://api.github.com/users/gijsk/following{/other_user}", "events_url": "https://api.github.com/users/gijsk/events{/privacy}", "organizations_url": "https://api.github.com/users/gijsk/orgs", "url": "https://api.github.com/users/gijsk", "gists_url": "https://api.github.com/users/gijsk/gists{/gist_id}", "html_url": "https://github.com/gijsk", "subscriptions_url": "https://api.github.com/users/gijsk/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/375983?v=4", "repos_url": "https://api.github.com/users/gijsk/repos", "received_events_url": "https://api.github.com/users/gijsk/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/gijsk/starred{/owner}{/repo}", "site_admin": false, "login": "gijsk", "type": "User", "id": 375983, "followers_url": "https://api.github.com/users/gijsk/followers"}, "position": null, "path": "recipe-client-addon/lib/NormandyDriver.jsm", "body_html": "<p>All this does is wrap <code>installObjectCallback</code>, which seems to have no other callers. Just put the contents of <code>installObjectCallback</code> straight into the promise function in here, then you don't need to pass reject/resolve around, either.</p>", "original_commit_id": "444db373a6c019ce7a4c7c2dd6e2a45c50724638", "id": 119477765}