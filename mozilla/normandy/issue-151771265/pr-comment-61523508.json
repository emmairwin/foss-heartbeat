{"original_position": 15, "diff_hunk": "@@ -293,10 +294,15 @@ def locale(self):\n \n     @cached_property\n     def country(self):\n-        try:\n-            ip_address = self.request.META['HTTP_X_FORWARDED_FOR'].split(',')[0]\n-        except (KeyError, IndexError):\n+        if settings.NUM_PROXIES == 0:", "body_text": "This might fit better in a utility method, like get_client_ip(request) or something.\nIt'd be easier to test too.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/126", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/61523508", "created_at": "2016-04-29T00:32:11Z", "author_association": "MEMBER", "body": "This might fit better in a utility method, like `get_client_ip(request)` or something.\n\nIt'd be easier to test too.\n", "updated_at": "2016-04-29T17:12:05Z", "html_url": "https://github.com/mozilla/normandy/pull/126#discussion_r61523508", "pull_request_review_id": null, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/61523508"}, "html": {"href": "https://github.com/mozilla/normandy/pull/126#discussion_r61523508"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/126"}}, "commit_id": "70c9f905e3e9ee855c40a665f685d1424b1b6c55", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "normandy/recipes/models.py", "body_html": "<p>This might fit better in a utility method, like <code>get_client_ip(request)</code> or something.</p>\n<p>It'd be easier to test too.</p>", "original_commit_id": "30a1003b058e95e0fb2005a3491646fb27b454c5", "id": 61523508}