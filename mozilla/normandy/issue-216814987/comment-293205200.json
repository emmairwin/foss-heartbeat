{"body": "`waiveXrays` is scary and we should try not to use it.\r\n\r\nAt a glance, it seems to me like this checks for storage durability for every sandbox we create from a driver/recipe. It seems like we should be able to have a shared state and don't need to use the sandbox for this, which would mean we wouldn't need to use waiveXrays and the overall implementation will likely be simpler. I'm happy to help look at this in more detail once you decide when/where/how to do this (not sure from the earlier comments if this will get reopened or we get a new issue or something else, also because I don't know about github flow).\r\n\r\nFinally, I would expect more tests to fail because of this change - effectively, unless you seed durability from a test file, AIUI on the first run of Firefox (which is what tests get, because clean profile), nothing will be in storage, and (the real) init() should only be called once, so we seed durability only once, so it will always be <2, so we don't run things. So more tests should fail. I'm probably missing something, but I would like to understand what, exactly. :-)", "body_text": "waiveXrays is scary and we should try not to use it.\nAt a glance, it seems to me like this checks for storage durability for every sandbox we create from a driver/recipe. It seems like we should be able to have a shared state and don't need to use the sandbox for this, which would mean we wouldn't need to use waiveXrays and the overall implementation will likely be simpler. I'm happy to help look at this in more detail once you decide when/where/how to do this (not sure from the earlier comments if this will get reopened or we get a new issue or something else, also because I don't know about github flow).\nFinally, I would expect more tests to fail because of this change - effectively, unless you seed durability from a test file, AIUI on the first run of Firefox (which is what tests get, because clean profile), nothing will be in storage, and (the real) init() should only be called once, so we seed durability only once, so it will always be <2, so we don't run things. So more tests should fail. I'm probably missing something, but I would like to understand what, exactly. :-)", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/293205200", "created_at": "2017-04-11T09:37:51Z", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/mozilla/normandy/pull/633#issuecomment-293205200", "updated_at": "2017-04-11T09:37:51Z", "user": {"following_url": "https://api.github.com/users/gijsk/following{/other_user}", "events_url": "https://api.github.com/users/gijsk/events{/privacy}", "organizations_url": "https://api.github.com/users/gijsk/orgs", "url": "https://api.github.com/users/gijsk", "gists_url": "https://api.github.com/users/gijsk/gists{/gist_id}", "html_url": "https://github.com/gijsk", "subscriptions_url": "https://api.github.com/users/gijsk/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/375983?v=4", "repos_url": "https://api.github.com/users/gijsk/repos", "received_events_url": "https://api.github.com/users/gijsk/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/gijsk/starred{/owner}{/repo}", "site_admin": false, "login": "gijsk", "type": "User", "id": 375983, "followers_url": "https://api.github.com/users/gijsk/followers"}, "body_html": "<p><code>waiveXrays</code> is scary and we should try not to use it.</p>\n<p>At a glance, it seems to me like this checks for storage durability for every sandbox we create from a driver/recipe. It seems like we should be able to have a shared state and don't need to use the sandbox for this, which would mean we wouldn't need to use waiveXrays and the overall implementation will likely be simpler. I'm happy to help look at this in more detail once you decide when/where/how to do this (not sure from the earlier comments if this will get reopened or we get a new issue or something else, also because I don't know about github flow).</p>\n<p>Finally, I would expect more tests to fail because of this change - effectively, unless you seed durability from a test file, AIUI on the first run of Firefox (which is what tests get, because clean profile), nothing will be in storage, and (the real) init() should only be called once, so we seed durability only once, so it will always be &lt;2, so we don't run things. So more tests should fail. I'm probably missing something, but I would like to understand what, exactly. :-)</p>", "id": 293205200, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/633"}