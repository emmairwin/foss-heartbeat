{"body": "After discussing things with @georgf, I think we need to change what telemetry preferences we're checking, and when. \r\n\r\nCurrently:\r\n\r\n- On startup, we check `toolkit.telemetry.unified`. If it is true, we continue. If it is false, we do not execute any recipes for the rest of the session.\r\n\r\nBased on my conversation with @georgf, `datareporting.healthreport.uploadEnabled` is the correct pref to represent that Telemetry is available. I'd like to change our checks to:\r\n\r\n- Always register the recipe run timer.\r\n- On each attempt to run, check `datareporting.healthreport.uploadEnabled`. If it is true, continue. If it is false, do not download or execute recipes.\r\n\r\n@MattGrimes @gregglind Heartbeat recipes currently use Telemetry to track user interaction with the prompt. Do we want to still run those recipes even if Telemetry is disabled? I think the answer is yes, since users may still fill out a survey or otherwise benefit from the prompt, but want to confirm.", "body_text": "After discussing things with @georgf, I think we need to change what telemetry preferences we're checking, and when.\nCurrently:\n\nOn startup, we check toolkit.telemetry.unified. If it is true, we continue. If it is false, we do not execute any recipes for the rest of the session.\n\nBased on my conversation with @georgf, datareporting.healthreport.uploadEnabled is the correct pref to represent that Telemetry is available. I'd like to change our checks to:\n\nAlways register the recipe run timer.\nOn each attempt to run, check datareporting.healthreport.uploadEnabled. If it is true, continue. If it is false, do not download or execute recipes.\n\n@MattGrimes @gregglind Heartbeat recipes currently use Telemetry to track user interaction with the prompt. Do we want to still run those recipes even if Telemetry is disabled? I think the answer is yes, since users may still fill out a survey or otherwise benefit from the prompt, but want to confirm.", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/331581632", "created_at": "2017-09-22T23:20:05Z", "author_association": "MEMBER", "html_url": "https://github.com/mozilla/normandy/issues/354#issuecomment-331581632", "updated_at": "2017-09-22T23:31:48Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "body_html": "<p>After discussing things with <a class=\"user-mention\" href=\"https://github.com/georgf\">@georgf</a>, I think we need to change what telemetry preferences we're checking, and when.</p>\n<p>Currently:</p>\n<ul>\n<li>On startup, we check <code>toolkit.telemetry.unified</code>. If it is true, we continue. If it is false, we do not execute any recipes for the rest of the session.</li>\n</ul>\n<p>Based on my conversation with <a class=\"user-mention\" href=\"https://github.com/georgf\">@georgf</a>, <code>datareporting.healthreport.uploadEnabled</code> is the correct pref to represent that Telemetry is available. I'd like to change our checks to:</p>\n<ul>\n<li>Always register the recipe run timer.</li>\n<li>On each attempt to run, check <code>datareporting.healthreport.uploadEnabled</code>. If it is true, continue. If it is false, do not download or execute recipes.</li>\n</ul>\n<p><a class=\"user-mention\" href=\"https://github.com/mattgrimes\">@MattGrimes</a> <a class=\"user-mention\" href=\"https://github.com/gregglind\">@gregglind</a> Heartbeat recipes currently use Telemetry to track user interaction with the prompt. Do we want to still run those recipes even if Telemetry is disabled? I think the answer is yes, since users may still fill out a survey or otherwise benefit from the prompt, but want to confirm.</p>", "id": 331581632, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/354"}