{"body_text": "This is based off #919; 3b45b72 is the new commit to review.\n@rhelmer The tests pass on this PR, but when I test it out manually with an XPI, my uninstall listener in AddonStudies.jsm is not called when I uninstall a study add-on via about:addons. Is there a reason why a listener for add-on uninstalls would not be called?\nThe TC run for this PR should have a task for building the XPI; check the artifacts there for a copy of the XPI if you want to test it out for yourself. You can use the following line in the browser console to create a new study entry in about:studies:\n// recipeId must be unique for each new study. \nCu.import(\"resource://shield-recipe-client/lib/AddonStudies.jsm\", {}).AddonStudies.start({recipeId: 9000, name: \"My Study\", description: \"Don't worry about it\", addonUrl: \"https://github.com/Osmose/jsonfile-example/releases/download/v1/jsonfile-example.xpi\"})", "labels": [], "number": 942, "assignee": null, "repository_url": "https://api.github.com/repos/mozilla/normandy", "closed_at": "2017-08-03T20:54:28Z", "body_html": "<p>This is based off <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"245568892\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/mozilla/normandy/issues/919\" href=\"https://github.com/mozilla/normandy/pull/919\">#919</a>; <a class=\"commit-link\" href=\"https://github.com/mozilla/normandy/commit/3b45b720cf14081c90c3effb147853d12a9b9795\"><tt>3b45b72</tt></a> is the new commit to review.</p>\n<p><a class=\"user-mention\" href=\"https://github.com/rhelmer\">@rhelmer</a> The tests pass on this PR, but when I test it out manually with an XPI, my uninstall listener in <code>AddonStudies.jsm</code> is not called when I uninstall a study add-on via <code>about:addons</code>. Is there a reason why a listener for add-on uninstalls would not be called?</p>\n<p>The TC run for this PR should have a task for building the XPI; check the artifacts there for a copy of the XPI if you want to test it out for yourself. You can use the following line in the browser console to create a new study entry in <code>about:studies</code>:</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-c\"><span class=\"pl-c\">//</span> recipeId must be unique for each new study. </span>\n<span class=\"pl-smi\">Cu</span>.<span class=\"pl-en\">import</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>resource://shield-recipe-client/lib/AddonStudies.jsm<span class=\"pl-pds\">\"</span></span>, {}).<span class=\"pl-smi\">AddonStudies</span>.<span class=\"pl-c1\">start</span>({recipeId<span class=\"pl-k\">:</span> <span class=\"pl-c1\">9000</span>, name<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>My Study<span class=\"pl-pds\">\"</span></span>, description<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Don't worry about it<span class=\"pl-pds\">\"</span></span>, addonUrl<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://github.com/Osmose/jsonfile-example/releases/download/v1/jsonfile-example.xpi<span class=\"pl-pds\">\"</span></span>})</pre></div>", "id": 246554210, "title": "Fix #940: Mark studies as ended if their add-ons are uninstalled.", "pull_request": {"url": "https://api.github.com/repos/mozilla/normandy/pulls/942", "diff_url": "https://github.com/mozilla/normandy/pull/942.diff", "html_url": "https://github.com/mozilla/normandy/pull/942", "patch_url": "https://github.com/mozilla/normandy/pull/942.patch"}, "comments": 6, "state": "closed", "body": "This is based off #919; 3b45b72 is the new commit to review.\r\n\r\n@rhelmer The tests pass on this PR, but when I test it out manually with an XPI, my uninstall listener in `AddonStudies.jsm` is not called when I uninstall a study add-on via `about:addons`. Is there a reason why a listener for add-on uninstalls would not be called?\r\n\r\nThe TC run for this PR should have a task for building the XPI; check the artifacts there for a copy of the XPI if you want to test it out for yourself. You can use the following line in the browser console to create a new study entry in `about:studies`:\r\n\r\n```js\r\n// recipeId must be unique for each new study. \r\nCu.import(\"resource://shield-recipe-client/lib/AddonStudies.jsm\", {}).AddonStudies.start({recipeId: 9000, name: \"My Study\", description: \"Don't worry about it\", addonUrl: \"https://github.com/Osmose/jsonfile-example/releases/download/v1/jsonfile-example.xpi\"})\r\n```", "events_url": "https://api.github.com/repos/mozilla/normandy/issues/942/events", "labels_url": "https://api.github.com/repos/mozilla/normandy/issues/942/labels{/name}", "author_association": "MEMBER", "comments_url": "https://api.github.com/repos/mozilla/normandy/issues/942/comments", "html_url": "https://github.com/mozilla/normandy/pull/942", "updated_at": "2017-08-03T20:54:31Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "milestone": null, "locked": false, "url": "https://api.github.com/repos/mozilla/normandy/issues/942", "created_at": "2017-07-30T00:42:28Z", "assignees": []}