{"original_position": 18, "diff_hunk": "@@ -54,13 +59,15 @@ export default class PreferenceExperimentAction extends Action {\n \n       // Otherwise, enroll!\n       const branch = await this.chooseBranch(branches);\n+      const experimentType = isHighPopulation ? 'normandy-exp-highpop' : 'normandy-exp';", "body_text": "Hm, but you're validating for the experimentType starting with normandy-pref in PreferenceExperiments.start(). Neither of these 2 strings match that.\nUnless I'm missing something, this means I'd like to see 2, maybe 3 changes:\n\nfix the string startsWith check and/or these names so that this does pass\nwrite a testcase that actually passes the 'high population' thing to the telemetry thing which would have thrown and shown something was wrong here (ie ensure we test the interaction between this code and the telemetry code, which apparently right now we don't or you would have noticed this!)\noptionally, switch this to something that isn't so stringly-typed. Like, I get that this is JS, but if we had a set of value constants defined on PreferenceExperiments that we used throughout then this would be a harder mistake to make/introduce.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/1114", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/150639652", "created_at": "2017-11-13T19:24:47Z", "author_association": "CONTRIBUTOR", "body": "Hm, but you're validating for the `experimentType` starting with `normandy-pref` in `PreferenceExperiments.start()`. Neither of these 2 strings match that.\r\n\r\nUnless I'm missing something, this means I'd like to see 2, maybe 3 changes:\r\n\r\n1) fix the string `startsWith` check and/or these names so that this does pass\r\n2) write a testcase that actually passes the 'high population' thing to the telemetry thing which would have thrown and shown something was wrong here (ie ensure we test the interaction between this code and the telemetry code, which apparently right now we don't or you would have noticed this!)\r\n3) optionally, switch this to something that isn't so stringly-typed. Like, I get that this is JS, but if we had a set of value constants defined on `PreferenceExperiments` that we used throughout then this would be a harder mistake to make/introduce.", "updated_at": "2017-11-16T19:05:50Z", "html_url": "https://github.com/mozilla/normandy/pull/1114#discussion_r150639652", "pull_request_review_id": 76219536, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/150639652"}, "html": {"href": "https://github.com/mozilla/normandy/pull/1114#discussion_r150639652"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1114"}}, "commit_id": "3f98712e9565a89ef4c155b0c284da1a95b27a27", "user": {"following_url": "https://api.github.com/users/gijsk/following{/other_user}", "events_url": "https://api.github.com/users/gijsk/events{/privacy}", "organizations_url": "https://api.github.com/users/gijsk/orgs", "url": "https://api.github.com/users/gijsk", "gists_url": "https://api.github.com/users/gijsk/gists{/gist_id}", "html_url": "https://github.com/gijsk", "subscriptions_url": "https://api.github.com/users/gijsk/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/375983?v=4", "repos_url": "https://api.github.com/users/gijsk/repos", "received_events_url": "https://api.github.com/users/gijsk/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/gijsk/starred{/owner}{/repo}", "site_admin": false, "login": "gijsk", "type": "User", "id": 375983, "followers_url": "https://api.github.com/users/gijsk/followers"}, "position": null, "path": "recipe-server/client/actions/preference-experiment/index.js", "body_html": "<p>Hm, but you're validating for the <code>experimentType</code> starting with <code>normandy-pref</code> in <code>PreferenceExperiments.start()</code>. Neither of these 2 strings match that.</p>\n<p>Unless I'm missing something, this means I'd like to see 2, maybe 3 changes:</p>\n<ol>\n<li>fix the string <code>startsWith</code> check and/or these names so that this does pass</li>\n<li>write a testcase that actually passes the 'high population' thing to the telemetry thing which would have thrown and shown something was wrong here (ie ensure we test the interaction between this code and the telemetry code, which apparently right now we don't or you would have noticed this!)</li>\n<li>optionally, switch this to something that isn't so stringly-typed. Like, I get that this is JS, but if we had a set of value constants defined on <code>PreferenceExperiments</code> that we used throughout then this would be a harder mistake to make/introduce.</li>\n</ol>", "original_commit_id": "eb1a56a5e311ad6e019c3ce29321c2f9da3c129d", "id": 150639652}