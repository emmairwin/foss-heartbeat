{"original_position": 35, "diff_hunk": "@@ -0,0 +1,126 @@\n+/* eslint-disable react/no-did-mount-set-state */\n+import { Button, Popover, Icon } from 'antd';\n+import autobind from 'autobind-decorator';\n+import React from 'react';\n+import PropTypes from 'prop-types';\n+\n+import ShieldIdenticon from 'control_new/components/common/ShieldIdenticon';\n+\n+@autobind\n+export default class IdenticonField extends React.PureComponent {\n+  static propTypes = {\n+    disabled: PropTypes.bool,\n+    onChange: PropTypes.func.isRequired,\n+    value: PropTypes.any,\n+  };\n+\n+  static defaultProps = {\n+    disabled: false,\n+    value: null,\n+  };\n+\n+  static generateSeed() {\n+    return `v1:${Math.random().toString(36).substr(2)}`;\n+  }\n+\n+  state = {\n+    history: [],\n+    index: -1,\n+  };\n+\n+  componentDidMount() {\n+    const { value } = this.props;\n+\n+    if (value) {\n+      this.setState({", "body_text": "I ended up changing this approach a little bit. The initial state is now set in the constructor, but still allows willReceiveProps to update accordingly (for instance, if the icon seed is not loaded on mount but then loads later on). This should avoid the re-render issue you mentioned and avoids disabling the eslint rule.", "in_reply_to_id": 139761847, "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/1038", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/140067588", "created_at": "2017-09-20T19:22:53Z", "author_association": "CONTRIBUTOR", "body": "I ended up changing this approach a little bit. The initial state is now set in the constructor, but still allows `willReceiveProps` to update accordingly (for instance, if the icon seed is not loaded on mount but then loads later on). This should avoid the re-render issue you mentioned and avoids disabling the eslint rule.", "updated_at": "2017-09-25T20:10:33Z", "html_url": "https://github.com/mozilla/normandy/pull/1038#discussion_r140067588", "pull_request_review_id": 64087773, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/140067588"}, "html": {"href": "https://github.com/mozilla/normandy/pull/1038#discussion_r140067588"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1038"}}, "commit_id": "58f13fafca6ae9b8bb32a1610d33a3d79aba7dfe", "user": {"following_url": "https://api.github.com/users/andymikulski/following{/other_user}", "events_url": "https://api.github.com/users/andymikulski/events{/privacy}", "organizations_url": "https://api.github.com/users/andymikulski/orgs", "url": "https://api.github.com/users/andymikulski", "gists_url": "https://api.github.com/users/andymikulski/gists{/gist_id}", "html_url": "https://github.com/andymikulski", "subscriptions_url": "https://api.github.com/users/andymikulski/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/2767162?v=4", "repos_url": "https://api.github.com/users/andymikulski/repos", "received_events_url": "https://api.github.com/users/andymikulski/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/andymikulski/starred{/owner}{/repo}", "site_admin": false, "login": "andymikulski", "type": "User", "id": 2767162, "followers_url": "https://api.github.com/users/andymikulski/followers"}, "position": null, "path": "recipe-server/client/control_new/components/forms/IdenticonField.js", "body_html": "<p>I ended up changing this approach a little bit. The initial state is now set in the constructor, but still allows <code>willReceiveProps</code> to update accordingly (for instance, if the icon seed is not loaded on mount but then loads later on). This should avoid the re-render issue you mentioned and avoids disabling the eslint rule.</p>", "original_commit_id": "ea6931f212723045859f9e75c7bc64063319a60f", "id": 140067588}