{"deletions": 1, "merge_commit_sha": "2d4e58c197036025dee696083757a4c52c2bfb63", "additions": 91, "labels": [{"url": "https://api.github.com/repos/mozilla/normandy/labels/new-feature", "color": "0e8a16", "default": false, "id": 821572171, "name": "new-feature"}], "number": 1202, "assignee": null, "mergeable": false, "closed_at": "2018-03-06T21:20:44Z", "requested_reviewers": [], "statuses_url": "https://api.github.com/repos/mozilla/normandy/statuses/2d4e58c197036025dee696083757a4c52c2bfb63", "id": 172985036, "maintainer_can_modify": false, "title": "enable CORS for REST endpoints, fixes #954", "body_text": "This way the most primitive CORS is enabled for all things /api/*. You can test it like this:\n\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\"  2>&1 | grep Access\n< Access-Control-Allow-Origin: *\n\nand\n\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\" -X OPTIONS 2>&1 | grep Access\n< Access-Control-Allow-Origin: *\n< Access-Control-Allow-Headers: accept, accept-encoding, authorization, content-type, dnt, origin, user-agent, x-csrftoken, x-requested-with\n< Access-Control-Allow-Methods: DELETE, GET, OPTIONS, PATCH, POST, PUT\n< Access-Control-Max-Age: 86400\n\nFor the production instance the Origin header needs to match a specific hardcoded list. I only put the production admin UI URL in there for now. This will need to change at some point to also include the domain for the production Delivery Console.\nIf we land this, I guess our Dev and Stage uses the Production DJANGO_CONFIGURATION so we're going to need to manually add whatever domains we use for doing prototypes. E.g. rdalal.github.io or something.", "comments": 7, "merged_at": "2018-03-06T21:20:44Z", "state": "closed", "_links": {"review_comment": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1202/commits"}, "self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1202"}, "review_comments": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1202/comments"}, "html": {"href": "https://github.com/mozilla/normandy/pull/1202"}, "comments": {"href": "https://api.github.com/repos/mozilla/normandy/issues/1202/comments"}, "issue": {"href": "https://api.github.com/repos/mozilla/normandy/issues/1202"}, "statuses": {"href": "https://api.github.com/repos/mozilla/normandy/statuses/2d4e58c197036025dee696083757a4c52c2bfb63"}}, "changed_files": 4, "diff_url": "https://github.com/mozilla/normandy/pull/1202.diff", "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/1202", "body": "This way the most primitive CORS is enabled for all things `/api/*`. You can test it like this:\r\n\r\n```\r\n\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\"  2>&1 | grep Access\r\n< Access-Control-Allow-Origin: *\r\n```\r\nand\r\n```\r\n\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\" -X OPTIONS 2>&1 | grep Access\r\n< Access-Control-Allow-Origin: *\r\n< Access-Control-Allow-Headers: accept, accept-encoding, authorization, content-type, dnt, origin, user-agent, x-csrftoken, x-requested-with\r\n< Access-Control-Allow-Methods: DELETE, GET, OPTIONS, PATCH, POST, PUT\r\n< Access-Control-Max-Age: 86400\r\n```\r\n\r\nFor the production instance the Origin header needs to match a specific hardcoded list. I only put the production admin UI URL in there for now. This will need to change at some point to also include the domain for the production Delivery Console. \r\n\r\nIf we land this, I guess our Dev and Stage uses the `Production` DJANGO_CONFIGURATION so we're going to need to manually add whatever domains we use for doing prototypes. E.g. rdalal.github.io or something. ", "head": {"repo": {"issues_url": "https://api.github.com/repos/peterbe/normandy/issues{/number}", "deployments_url": "https://api.github.com/repos/peterbe/normandy/deployments", "stargazers_count": 0, "forks_url": "https://api.github.com/repos/peterbe/normandy/forks", "mirror_url": null, "subscription_url": "https://api.github.com/repos/peterbe/normandy/subscription", "notifications_url": "https://api.github.com/repos/peterbe/normandy/notifications{?since,all,participating}", "collaborators_url": "https://api.github.com/repos/peterbe/normandy/collaborators{/collaborator}", "updated_at": "2018-02-08T20:32:17Z", "private": false, "pulls_url": "https://api.github.com/repos/peterbe/normandy/pulls{/number}", "issue_comment_url": "https://api.github.com/repos/peterbe/normandy/issues/comments{/number}", "labels_url": "https://api.github.com/repos/peterbe/normandy/labels{/name}", "has_wiki": false, "full_name": "peterbe/normandy", "owner": {"following_url": "https://api.github.com/users/peterbe/following{/other_user}", "events_url": "https://api.github.com/users/peterbe/events{/privacy}", "organizations_url": "https://api.github.com/users/peterbe/orgs", "url": "https://api.github.com/users/peterbe", "gists_url": "https://api.github.com/users/peterbe/gists{/gist_id}", "html_url": "https://github.com/peterbe", "subscriptions_url": "https://api.github.com/users/peterbe/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/26739?v=4", "repos_url": "https://api.github.com/users/peterbe/repos", "received_events_url": "https://api.github.com/users/peterbe/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/peterbe/starred{/owner}{/repo}", "site_admin": false, "login": "peterbe", "type": "User", "id": 26739, "followers_url": "https://api.github.com/users/peterbe/followers"}, "statuses_url": "https://api.github.com/repos/peterbe/normandy/statuses/{sha}", "id": 120814443, "keys_url": "https://api.github.com/repos/peterbe/normandy/keys{/key_id}", "description": "Firefox recipe server", "tags_url": "https://api.github.com/repos/peterbe/normandy/tags", "archived": false, "downloads_url": "https://api.github.com/repos/peterbe/normandy/downloads", "assignees_url": "https://api.github.com/repos/peterbe/normandy/assignees{/user}", "contents_url": "https://api.github.com/repos/peterbe/normandy/contents/{+path}", "has_pages": false, "git_refs_url": "https://api.github.com/repos/peterbe/normandy/git/refs{/sha}", "open_issues_count": 0, "has_projects": true, "clone_url": "https://github.com/peterbe/normandy.git", "watchers_count": 0, "git_tags_url": "https://api.github.com/repos/peterbe/normandy/git/tags{/sha}", "milestones_url": "https://api.github.com/repos/peterbe/normandy/milestones{/number}", "languages_url": "https://api.github.com/repos/peterbe/normandy/languages", "size": 5995, "homepage": "https://wiki.mozilla.org/Firefox/Recipe_Server", "fork": true, "commits_url": "https://api.github.com/repos/peterbe/normandy/commits{/sha}", "releases_url": "https://api.github.com/repos/peterbe/normandy/releases{/id}", "issue_events_url": "https://api.github.com/repos/peterbe/normandy/issues/events{/number}", "archive_url": "https://api.github.com/repos/peterbe/normandy/{archive_format}{/ref}", "comments_url": "https://api.github.com/repos/peterbe/normandy/comments{/number}", "events_url": "https://api.github.com/repos/peterbe/normandy/events", "contributors_url": "https://api.github.com/repos/peterbe/normandy/contributors", "html_url": "https://github.com/peterbe/normandy", "forks": 0, "compare_url": "https://api.github.com/repos/peterbe/normandy/compare/{base}...{head}", "open_issues": 0, "watchers": 0, "git_url": "git://github.com/peterbe/normandy.git", "svn_url": "https://github.com/peterbe/normandy", "merges_url": "https://api.github.com/repos/peterbe/normandy/merges", "has_issues": false, "ssh_url": "git@github.com:peterbe/normandy.git", "blobs_url": "https://api.github.com/repos/peterbe/normandy/git/blobs{/sha}", "git_commits_url": "https://api.github.com/repos/peterbe/normandy/git/commits{/sha}", "hooks_url": "https://api.github.com/repos/peterbe/normandy/hooks", "has_downloads": true, "license": null, "name": "normandy", "language": "Python", "url": "https://api.github.com/repos/peterbe/normandy", "created_at": "2018-02-08T20:32:14Z", "pushed_at": "2018-03-14T18:44:47Z", "forks_count": 0, "default_branch": "master", "teams_url": "https://api.github.com/repos/peterbe/normandy/teams", "trees_url": "https://api.github.com/repos/peterbe/normandy/git/trees{/sha}", "branches_url": "https://api.github.com/repos/peterbe/normandy/branches{/branch}", "subscribers_url": "https://api.github.com/repos/peterbe/normandy/subscribers", "stargazers_url": "https://api.github.com/repos/peterbe/normandy/stargazers"}, "sha": "2d4e58c197036025dee696083757a4c52c2bfb63", "ref": "enable-cors-for-rest-endpoints-fixes-954", "user": {"following_url": "https://api.github.com/users/peterbe/following{/other_user}", "events_url": "https://api.github.com/users/peterbe/events{/privacy}", "organizations_url": "https://api.github.com/users/peterbe/orgs", "url": "https://api.github.com/users/peterbe", "gists_url": "https://api.github.com/users/peterbe/gists{/gist_id}", "html_url": "https://github.com/peterbe", "subscriptions_url": "https://api.github.com/users/peterbe/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/26739?v=4", "repos_url": "https://api.github.com/users/peterbe/repos", "received_events_url": "https://api.github.com/users/peterbe/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/peterbe/starred{/owner}{/repo}", "site_admin": false, "login": "peterbe", "type": "User", "id": 26739, "followers_url": "https://api.github.com/users/peterbe/followers"}, "label": "peterbe:enable-cors-for-rest-endpoints-fixes-954"}, "commits_url": "https://api.github.com/repos/mozilla/normandy/pulls/1202/commits", "commits": 5, "author_association": "CONTRIBUTOR", "comments_url": "https://api.github.com/repos/mozilla/normandy/issues/1202/comments", "html_url": "https://github.com/mozilla/normandy/pull/1202", "rebaseable": false, "updated_at": "2018-03-06T21:48:35Z", "base": {"repo": {"issues_url": "https://api.github.com/repos/mozilla/normandy/issues{/number}", "deployments_url": "https://api.github.com/repos/mozilla/normandy/deployments", "stargazers_count": 24, "forks_url": "https://api.github.com/repos/mozilla/normandy/forks", "mirror_url": null, "subscription_url": "https://api.github.com/repos/mozilla/normandy/subscription", "notifications_url": "https://api.github.com/repos/mozilla/normandy/notifications{?since,all,participating}", "collaborators_url": "https://api.github.com/repos/mozilla/normandy/collaborators{/collaborator}", "updated_at": "2018-03-14T22:20:49Z", "private": false, "pulls_url": "https://api.github.com/repos/mozilla/normandy/pulls{/number}", "issue_comment_url": "https://api.github.com/repos/mozilla/normandy/issues/comments{/number}", "labels_url": "https://api.github.com/repos/mozilla/normandy/labels{/name}", "has_wiki": false, "full_name": "mozilla/normandy", "owner": {"following_url": "https://api.github.com/users/mozilla/following{/other_user}", "events_url": "https://api.github.com/users/mozilla/events{/privacy}", "organizations_url": "https://api.github.com/users/mozilla/orgs", "url": "https://api.github.com/users/mozilla", "gists_url": "https://api.github.com/users/mozilla/gists{/gist_id}", "html_url": "https://github.com/mozilla", "subscriptions_url": "https://api.github.com/users/mozilla/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/131524?v=4", "repos_url": "https://api.github.com/users/mozilla/repos", "received_events_url": "https://api.github.com/users/mozilla/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mozilla/starred{/owner}{/repo}", "site_admin": false, "login": "mozilla", "type": "Organization", "id": 131524, "followers_url": "https://api.github.com/users/mozilla/followers"}, "statuses_url": "https://api.github.com/repos/mozilla/normandy/statuses/{sha}", "id": 48456638, "keys_url": "https://api.github.com/repos/mozilla/normandy/keys{/key_id}", "description": "Firefox recipe server", "tags_url": "https://api.github.com/repos/mozilla/normandy/tags", "archived": false, "downloads_url": "https://api.github.com/repos/mozilla/normandy/downloads", "assignees_url": "https://api.github.com/repos/mozilla/normandy/assignees{/user}", "contents_url": "https://api.github.com/repos/mozilla/normandy/contents/{+path}", "has_pages": false, "git_refs_url": "https://api.github.com/repos/mozilla/normandy/git/refs{/sha}", "open_issues_count": 73, "has_projects": true, "clone_url": "https://github.com/mozilla/normandy.git", "watchers_count": 24, "git_tags_url": "https://api.github.com/repos/mozilla/normandy/git/tags{/sha}", "milestones_url": "https://api.github.com/repos/mozilla/normandy/milestones{/number}", "languages_url": "https://api.github.com/repos/mozilla/normandy/languages", "size": 6015, "homepage": "https://wiki.mozilla.org/Firefox/Recipe_Server", "fork": false, "commits_url": "https://api.github.com/repos/mozilla/normandy/commits{/sha}", "releases_url": "https://api.github.com/repos/mozilla/normandy/releases{/id}", "issue_events_url": "https://api.github.com/repos/mozilla/normandy/issues/events{/number}", "archive_url": "https://api.github.com/repos/mozilla/normandy/{archive_format}{/ref}", "comments_url": "https://api.github.com/repos/mozilla/normandy/comments{/number}", "events_url": "https://api.github.com/repos/mozilla/normandy/events", "contributors_url": "https://api.github.com/repos/mozilla/normandy/contributors", "html_url": "https://github.com/mozilla/normandy", "forks": 39, "compare_url": "https://api.github.com/repos/mozilla/normandy/compare/{base}...{head}", "open_issues": 73, "watchers": 24, "git_url": "git://github.com/mozilla/normandy.git", "svn_url": "https://github.com/mozilla/normandy", "merges_url": "https://api.github.com/repos/mozilla/normandy/merges", "has_issues": true, "ssh_url": "git@github.com:mozilla/normandy.git", "blobs_url": "https://api.github.com/repos/mozilla/normandy/git/blobs{/sha}", "git_commits_url": "https://api.github.com/repos/mozilla/normandy/git/commits{/sha}", "hooks_url": "https://api.github.com/repos/mozilla/normandy/hooks", "has_downloads": true, "license": null, "name": "normandy", "language": "Python", "url": "https://api.github.com/repos/mozilla/normandy", "created_at": "2015-12-22T22:18:19Z", "pushed_at": "2018-03-14T22:20:47Z", "forks_count": 39, "default_branch": "master", "teams_url": "https://api.github.com/repos/mozilla/normandy/teams", "trees_url": "https://api.github.com/repos/mozilla/normandy/git/trees{/sha}", "branches_url": "https://api.github.com/repos/mozilla/normandy/branches{/branch}", "subscribers_url": "https://api.github.com/repos/mozilla/normandy/subscribers", "stargazers_url": "https://api.github.com/repos/mozilla/normandy/stargazers"}, "sha": "3e30f6dcdebadbb37b84e017ae809fc500bc6171", "ref": "master", "user": {"following_url": "https://api.github.com/users/mozilla/following{/other_user}", "events_url": "https://api.github.com/users/mozilla/events{/privacy}", "organizations_url": "https://api.github.com/users/mozilla/orgs", "url": "https://api.github.com/users/mozilla", "gists_url": "https://api.github.com/users/mozilla/gists{/gist_id}", "html_url": "https://github.com/mozilla", "subscriptions_url": "https://api.github.com/users/mozilla/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/131524?v=4", "repos_url": "https://api.github.com/users/mozilla/repos", "received_events_url": "https://api.github.com/users/mozilla/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mozilla/starred{/owner}{/repo}", "site_admin": false, "login": "mozilla", "type": "Organization", "id": 131524, "followers_url": "https://api.github.com/users/mozilla/followers"}, "label": "mozilla:master"}, "user": {"following_url": "https://api.github.com/users/peterbe/following{/other_user}", "events_url": "https://api.github.com/users/peterbe/events{/privacy}", "organizations_url": "https://api.github.com/users/peterbe/orgs", "url": "https://api.github.com/users/peterbe", "gists_url": "https://api.github.com/users/peterbe/gists{/gist_id}", "html_url": "https://github.com/peterbe", "subscriptions_url": "https://api.github.com/users/peterbe/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/26739?v=4", "repos_url": "https://api.github.com/users/peterbe/repos", "received_events_url": "https://api.github.com/users/peterbe/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/peterbe/starred{/owner}{/repo}", "site_admin": false, "login": "peterbe", "type": "User", "id": 26739, "followers_url": "https://api.github.com/users/peterbe/followers"}, "milestone": null, "requested_teams": [], "locked": false, "merged_by": {"following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "url": "https://api.github.com/users/bors%5Bbot%5D", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "html_url": "https://github.com/apps/bors", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/in/1847?v=4", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "site_admin": false, "login": "bors[bot]", "type": "Bot", "id": 26634292, "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers"}, "url": "https://api.github.com/repos/mozilla/normandy/pulls/1202", "mergeable_state": "dirty", "created_at": "2018-03-05T21:00:57Z", "merged": true, "review_comments_url": "https://api.github.com/repos/mozilla/normandy/pulls/1202/comments", "review_comments": 9, "assignees": [], "review_comment_url": "https://api.github.com/repos/mozilla/normandy/pulls/comments{/number}", "patch_url": "https://github.com/mozilla/normandy/pull/1202.patch", "body_html": "<p>This way the most primitive CORS is enabled for all things <code>/api/*</code>. You can test it like this:</p>\n<pre><code>\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\"  2&gt;&amp;1 | grep Access\n&lt; Access-Control-Allow-Origin: *\n</code></pre>\n<p>and</p>\n<pre><code>\u25b6 curl -v -k https://localhost:8000/api/v2/recipe/ -H \"Origin: http://example.com\" -X OPTIONS 2&gt;&amp;1 | grep Access\n&lt; Access-Control-Allow-Origin: *\n&lt; Access-Control-Allow-Headers: accept, accept-encoding, authorization, content-type, dnt, origin, user-agent, x-csrftoken, x-requested-with\n&lt; Access-Control-Allow-Methods: DELETE, GET, OPTIONS, PATCH, POST, PUT\n&lt; Access-Control-Max-Age: 86400\n</code></pre>\n<p>For the production instance the Origin header needs to match a specific hardcoded list. I only put the production admin UI URL in there for now. This will need to change at some point to also include the domain for the production Delivery Console.</p>\n<p>If we land this, I guess our Dev and Stage uses the <code>Production</code> DJANGO_CONFIGURATION so we're going to need to manually add whatever domains we use for doing prototypes. E.g. rdalal.github.io or something.</p>"}