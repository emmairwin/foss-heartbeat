{"original_position": 46, "diff_hunk": "@@ -0,0 +1,68 @@\n+class CounterBackend:\n+    \"\"\"Base class for counter backends.\"\"\"\n+\n+    def increment(name):\n+        \"\"\"\n+        Increment the counter named `name`.\n+\n+        If no such counter exists, it will be created with a value of 1.\n+        \"\"\"\n+        raise NotImplemented\n+\n+    def get(name):\n+        \"\"\"\n+        Retrieve the value of the counter named `name`.\n+\n+        If no such counter exists, returns 0.\n+        \"\"\"\n+        raise NotImplemented\n+\n+\n+class InMemoryCounterBackend(CounterBackend):\n+\n+    def __init__(self):\n+        self.counts = {}\n+\n+    def increment(self, name):\n+        val = self.counts.get(name, 0)\n+        self.counts[name] = val + 1\n+\n+    def get(self, name):\n+        val = self.counts.get(name, 0)\n+        return val\n+\n+\n+# TODO: This should probably be a setting.\n+_counter_backend = InMemoryCounterBackend\n+\n+class Counter:\n+\n+    def __init__(self):\n+        self.backend = _counter_backend()\n+\n+    def _recipe_name(self, recipe):\n+        return 'recipe-{}'.format(recipe.pk)\n+\n+    def check(self, recipe):", "body_text": "needs_more_hits? can_deliver?", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/4", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/49639795", "created_at": "2016-01-13T19:40:26Z", "author_association": "MEMBER", "body": "`needs_more_hits`? `can_deliver`?\n", "updated_at": "2016-01-13T19:59:30Z", "html_url": "https://github.com/mozilla/normandy/pull/4#discussion_r49639795", "pull_request_review_id": null, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/49639795"}, "html": {"href": "https://github.com/mozilla/normandy/pull/4#discussion_r49639795"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/4"}}, "commit_id": "604de9893c8def373ee8c1e807a8b6517a74678e", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "normandy/counters/__init__.py", "body_html": "<p><code>needs_more_hits</code>? <code>can_deliver</code>?</p>", "original_commit_id": "f285258920e04dde1e4a9d25d7f48577842f71d2", "id": 49639795}