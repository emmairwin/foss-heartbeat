{"body": "For completeness, here is the CSP report that is sent to the report URL:\r\n\r\n```json\r\n{\r\n  \"blocked-uri\": \"self\",\r\n  \"document-uri\": \"https://localhost:8000/control/\",\r\n  \"original-policy\": \"block-all-mixed-content; form-action https://localhost:8000; object-src 'none'; frame-src 'none'; default-src https://localhost:8000; base-uri 'none'; report-uri https://localhost:8000/__cspreport__\",\r\n  \"referrer\": \"\",\r\n  \"script-sample\": \"background: #000;\",\r\n  \"source-file\": \"https://localhost:8000/control/\",\r\n  \"violated-directive\": \"default-src https://localhost:8000\"\r\n}\r\n```\r\n\r\nThis is also the most common violated directive we see in prod, based on the CSP report logs. I think this requires a bit more research to figure out what the right thing to do is. I'm open to suggestions. Is it safe to enable `default-src self`? Or would that open us up to attacks?\r\n\r\nCC @jvehent", "body_text": "For completeness, here is the CSP report that is sent to the report URL:\n{\n  \"blocked-uri\": \"self\",\n  \"document-uri\": \"https://localhost:8000/control/\",\n  \"original-policy\": \"block-all-mixed-content; form-action https://localhost:8000; object-src 'none'; frame-src 'none'; default-src https://localhost:8000; base-uri 'none'; report-uri https://localhost:8000/__cspreport__\",\n  \"referrer\": \"\",\n  \"script-sample\": \"background: #000;\",\n  \"source-file\": \"https://localhost:8000/control/\",\n  \"violated-directive\": \"default-src https://localhost:8000\"\n}\nThis is also the most common violated directive we see in prod, based on the CSP report logs. I think this requires a bit more research to figure out what the right thing to do is. I'm open to suggestions. Is it safe to enable default-src self? Or would that open us up to attacks?\nCC @jvehent", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/288131122", "created_at": "2017-03-21T16:14:22Z", "author_association": "MEMBER", "html_url": "https://github.com/mozilla/normandy/issues/621#issuecomment-288131122", "updated_at": "2017-03-21T16:14:22Z", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "body_html": "<p>For completeness, here is the CSP report that is sent to the report URL:</p>\n<div class=\"highlight highlight-source-json\"><pre>{\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>blocked-uri<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>self<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>document-uri<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://localhost:8000/control/<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>original-policy<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>block-all-mixed-content; form-action https://localhost:8000; object-src 'none'; frame-src 'none'; default-src https://localhost:8000; base-uri 'none'; report-uri https://localhost:8000/__cspreport__<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>referrer<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>script-sample<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>background: #000;<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>source-file<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://localhost:8000/control/<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>violated-directive<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>default-src https://localhost:8000<span class=\"pl-pds\">\"</span></span>\n}</pre></div>\n<p>This is also the most common violated directive we see in prod, based on the CSP report logs. I think this requires a bit more research to figure out what the right thing to do is. I'm open to suggestions. Is it safe to enable <code>default-src self</code>? Or would that open us up to attacks?</p>\n<p>CC <a class=\"user-mention\" href=\"https://github.com/jvehent\">@jvehent</a></p>", "id": 288131122, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/621"}