{"original_position": 45, "diff_hunk": "@@ -10,29 +11,47 @@ import {\n } from '../requests/actions';\n \n \n-export function fetchRecipe(pk) {\n-  return async dispatch => {\n-    const requestId = `fetch-recipe-${pk}`;\n-    const recipe = await dispatch(makeApiRequest(requestId, `recipe/${pk}/`));\n+function recipeReceived(dispatch, recipe) {\n+  dispatch({\n+    type: RECIPE_RECEIVE,\n+    recipe,\n+  });\n+\n+  dispatch({\n+    type: ACTION_RECEIVE,\n+    action: recipe.action,\n+  });\n \n+  dispatch({\n+    type: REVISION_RECEIVE,\n+    revision: recipe.latest_revision,\n+  });\n+\n+  if (recipe.approved_revision) {\n     dispatch({\n-      type: RECIPE_RECEIVE,\n-      recipe,\n+      type: REVISION_RECEIVE,\n+      revision: recipe.approved_revision,\n     });\n+  }\n+}\n+\n+\n+export function fetchRecipe(pk) {\n+  return async dispatch => {\n+    const requestId = `fetch-recipe-${pk}`;\n+    const recipe = await dispatch(makeApiRequest(requestId, `v2/recipe/${pk}/`));\n+    recipeReceived(dispatch, recipe);", "body_text": "Can we make these use the normal action creator pattern, dispatch(recipeReceived(recipe)), and make recipeReceived use a thunk? I think that sticking to that pattern would be good.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/761", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/116613340", "created_at": "2017-05-15T22:10:23Z", "author_association": "MEMBER", "body": "Can we make these use the normal action creator pattern, `dispatch(recipeReceived(recipe))`, and make `recipeReceived` use a thunk? I think that sticking to that pattern would be good.", "updated_at": "2017-05-16T22:27:30Z", "html_url": "https://github.com/mozilla/normandy/pull/761#discussion_r116613340", "pull_request_review_id": 38247746, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/116613340"}, "html": {"href": "https://github.com/mozilla/normandy/pull/761#discussion_r116613340"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/761"}}, "commit_id": "7a61a73e4ac7807a723e33506e52587520ebc564", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "recipe-server/client/control/state/recipes/actions.js", "body_html": "<p>Can we make these use the normal action creator pattern, <code>dispatch(recipeReceived(recipe))</code>, and make <code>recipeReceived</code> use a thunk? I think that sticking to that pattern would be good.</p>", "original_commit_id": "f1a036298db577a8cf93d1cbab9dcec433bd5419", "id": 116613340}