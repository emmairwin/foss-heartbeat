{"original_position": 66, "diff_hunk": "@@ -148,11 +155,11 @@ add_task(withMockExperiments(withMockPreferences(async function (experiments, mo\n     expired: false,\n     preferenceName: \"fake.preference\",\n     preferenceValue: \"newvalue\",\n+    preferenceType: \"string\",\n     previousPreferenceValue: \"oldvalue\",\n     preferenceBranchType: \"user\",\n   };\n-  const experiment = {};\n-  Object.keys(expectedExperiment).forEach(key => experiment[key] = experiments.test[key]);\n+  const experiment = Object.assign({}, expectedExperiment);", "body_text": "The original lines copied experiments.test, but only copied the keys from experiment. The intent was to only do a comparison of the values we care about, in case the experiment data ended up including more data later. The new line doesn't handle that, and should be changed back.\nAlthough to be honest it's a confusing bit of code, and I should've left a comment mentioning that in the first place. My bad!", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/673", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/112111597", "created_at": "2017-04-19T04:01:08Z", "author_association": "MEMBER", "body": "The original lines copied `experiments.test`, but only copied the keys from `experiment`. The intent was to only do a comparison of the values we care about, in case the experiment data ended up including more data later. The new line doesn't handle that, and should be changed back.\r\n\r\nAlthough to be honest it's a confusing bit of code, and I should've left a comment mentioning that in the first place. My bad!", "updated_at": "2017-04-20T14:39:26Z", "html_url": "https://github.com/mozilla/normandy/pull/673#discussion_r112111597", "pull_request_review_id": 33399415, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/112111597"}, "html": {"href": "https://github.com/mozilla/normandy/pull/673#discussion_r112111597"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/673"}}, "commit_id": "0481af5b14c3a214840bcb56387fdf293f7386a8", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "recipe-client-addon/test/unit/test_PreferenceExperiments.js", "body_html": "<p>The original lines copied <code>experiments.test</code>, but only copied the keys from <code>experiment</code>. The intent was to only do a comparison of the values we care about, in case the experiment data ended up including more data later. The new line doesn't handle that, and should be changed back.</p>\n<p>Although to be honest it's a confusing bit of code, and I should've left a comment mentioning that in the first place. My bad!</p>", "original_commit_id": "d74e71bc7c86d392e193d79a3cc819bb7d2427c6", "id": 112111597}