{"original_position": 12, "diff_hunk": "@@ -61,13 +61,17 @@ export function saveSession() {\n   };\n }\n \n-export function addSessionView(category, caption) {\n+export function addSessionView(category, caption, identicon) {\n   return async (dispatch, getState) => {\n-    const url = getState().router.pathname;\n+    let url = getState().router.pathname;\n+\n+    // Prevent exact subpages (e.g. edit, clone pages) from appearing in the nav.\n+    // Instead, this will link to the 'view' page for that recipe/revision.\n+    url = url.replace(/\\/(edit|clone|approval_history)/, '');", "body_text": "This seems fragile. It requires this function to know about all the rest of the code, and makes it less re-usable. I think this should be refactored so that callers pass the URL. That way each individual caller can manager how it's URLs need to be deduplicated.\nEither that, or this sort of \"parent page\" information should be stored on the route, so it is stored in a central place with the routing information.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/1076", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/141440187", "created_at": "2017-09-27T19:11:05Z", "author_association": "MEMBER", "body": "This seems fragile. It requires this function to know about all the rest of the code, and makes it less re-usable. I think this should be refactored so that callers pass the URL. That way each individual caller can manager how it's URLs need to be deduplicated.\r\n\r\nEither that, or this sort of \"parent page\" information should be stored on the route, so it is stored in a central place with the routing information.", "updated_at": "2017-10-10T19:55:40Z", "html_url": "https://github.com/mozilla/normandy/pull/1076#discussion_r141440187", "pull_request_review_id": 65654614, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/141440187"}, "html": {"href": "https://github.com/mozilla/normandy/pull/1076#discussion_r141440187"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1076"}}, "commit_id": "11d4a8a279c5ce66bdcd0b7c7b5bf1f236848d12", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "recipe-server/client/control/state/app/session/actions.js", "body_html": "<p>This seems fragile. It requires this function to know about all the rest of the code, and makes it less re-usable. I think this should be refactored so that callers pass the URL. That way each individual caller can manager how it's URLs need to be deduplicated.</p>\n<p>Either that, or this sort of \"parent page\" information should be stored on the route, so it is stored in a central place with the routing information.</p>", "original_commit_id": "5eb36e7d305d685d603f7e2222652df99fb9b697", "id": 141440187}