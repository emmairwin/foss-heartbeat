{"original_position": 51, "diff_hunk": "@@ -1,27 +1,93 @@\n import React from 'react'\n import { connect } from 'react-redux'\n import { Link } from 'react-router'\n+import { destroy, reduxForm, getValues } from 'redux-form'\n+import { _ } from 'underscore'\n+\n+import apiFetch from '../utils/apiFetch.js';\n+import { parseJsonSchema, generateFieldsFromSchema } from '../utils/formSchemaHelpers.js';\n+\n import ControlActions from '../actions/ControlActions.js'\n-import { reduxForm } from 'redux-form'\n import composeRecipeContainer from './RecipeContainer.jsx'\n-\n+import ActionForm from './ActionForm.jsx'\n \n class RecipeForm extends React.Component {\n   constructor(props) {\n     super(props);\n     this.submitForm = this.submitForm.bind(this);\n+    this.getAvailableActions = this.getAvailableActions.bind(this);\n+    this.changeAction = this.changeAction.bind(this);\n+\n+    this.state = {\n+      availableActions: [],\n+      selectedAction: null,\n+    };\n+  }\n+\n+  getAvailableActions(recipeId) {\n+    apiFetch(`/api/v1/action/`)\n+      .then(availableActions => {\n+        let selectedActionName = (this.props.recipe ? this.props.recipe.action_name : null);\n+\n+        availableActions.map(action => {\n+          parseJsonSchema(action.arguments_schema).then(schema => {\n+            action.arguments_schema = schema;\n+            action.fields = generateFieldsFromSchema(schema);\n+\n+            if (selectedActionName === action.name) {\n+              this.setState({\n+                selectedAction: action\n+              });\n+            }\n+            return action;\n+          })\n+        });\n+\n+        this.setState({\n+          availableActions\n+        });\n+    });", "body_text": "This is super nitty, so feel free to ignore me. With .then on a new line, indenting it always results in these double-detents, which seem weird to me (and harder to read).\nI usually do this:\nfetchTheThing('foo')\n.then(foo => {\n   foo.bar();\n});\ninstead of this\nfetchTheThing('foo')\n  .then(foo => {\n    foo.bar();\n  });\nEither way, I think we should standardize on one or the other. Since you're writing most of this code, you should go with whatever you like better. (Can we encode this in eslint?)", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/147", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/63918384", "created_at": "2016-05-19T17:15:39Z", "author_association": "MEMBER", "body": "This is super nitty, so feel free to ignore me. With `.then` on a new line, indenting it always results in these double-detents, which seem weird to me (and harder to read).\n\nI usually do this:\n\n``` js\nfetchTheThing('foo')\n.then(foo => {\n   foo.bar();\n});\n```\n\ninstead of this\n\n``` js\nfetchTheThing('foo')\n  .then(foo => {\n    foo.bar();\n  });\n```\n\nEither way, I think we should standardize on one or the other. Since you're writing most of this code, you should go with whatever you like better. (Can we encode this in eslint?)\n", "updated_at": "2016-06-11T20:31:01Z", "html_url": "https://github.com/mozilla/normandy/pull/147#discussion_r63918384", "pull_request_review_id": null, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/63918384"}, "html": {"href": "https://github.com/mozilla/normandy/pull/147#discussion_r63918384"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/147"}}, "commit_id": "e9e64618bd413173d122d6fc56dced3ae4d47462", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "normandy/control/static/control/js/components/RecipeForm.jsx", "body_html": "<p>This is super nitty, so feel free to ignore me. With <code>.then</code> on a new line, indenting it always results in these double-detents, which seem weird to me (and harder to read).</p>\n<p>I usually do this:</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-en\">fetchTheThing</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>foo<span class=\"pl-pds\">'</span></span>)\n.<span class=\"pl-en\">then</span>(<span class=\"pl-smi\">foo</span> <span class=\"pl-k\">=&gt;</span> {\n   <span class=\"pl-smi\">foo</span>.<span class=\"pl-en\">bar</span>();\n});</pre></div>\n<p>instead of this</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-en\">fetchTheThing</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>foo<span class=\"pl-pds\">'</span></span>)\n  .<span class=\"pl-en\">then</span>(<span class=\"pl-smi\">foo</span> <span class=\"pl-k\">=&gt;</span> {\n    <span class=\"pl-smi\">foo</span>.<span class=\"pl-en\">bar</span>();\n  });</pre></div>\n<p>Either way, I think we should standardize on one or the other. Since you're writing most of this code, you should go with whatever you like better. (Can we encode this in eslint?)</p>", "original_commit_id": "cd3ec6f8db5081cb3be2c4f890fb775368079c40", "id": 63918384}