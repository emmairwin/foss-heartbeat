{"body": "> What's the use case for being able to watch for preference changes from an action? I think this isn't something we should copy from Preferences.jsm. It will be difficult to get right, and we would have to trust actions to eventually clean up their watchers, or else we'd leak everything.\r\n\r\nIf a user modifies the preference being used by an experiment, we need to immediately remove them from the experiment and tell telemetry to stop sending data from that user.\r\n\r\nThere's actually a problem with the spec here, in that if the user modifies the test preference before recipes are executed (internet issues, or just doing it before the 5-minute delay after startup), then nothing will be monitoring the preference and they could be sending telemetry data with them in the experiment but with the wrong preference value. That might be edgy-enough of an edge case that we don't care, though.", "body_text": "What's the use case for being able to watch for preference changes from an action? I think this isn't something we should copy from Preferences.jsm. It will be difficult to get right, and we would have to trust actions to eventually clean up their watchers, or else we'd leak everything.\n\nIf a user modifies the preference being used by an experiment, we need to immediately remove them from the experiment and tell telemetry to stop sending data from that user.\nThere's actually a problem with the spec here, in that if the user modifies the test preference before recipes are executed (internet issues, or just doing it before the 5-minute delay after startup), then nothing will be monitoring the preference and they could be sending telemetry data with them in the experiment but with the wrong preference value. That might be edgy-enough of an edge case that we don't care, though.", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/284603162", "created_at": "2017-03-07T02:35:52Z", "author_association": "MEMBER", "html_url": "https://github.com/mozilla/normandy/issues/589#issuecomment-284603162", "updated_at": "2017-03-07T02:35:52Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "body_html": "<blockquote>\n<p>What's the use case for being able to watch for preference changes from an action? I think this isn't something we should copy from Preferences.jsm. It will be difficult to get right, and we would have to trust actions to eventually clean up their watchers, or else we'd leak everything.</p>\n</blockquote>\n<p>If a user modifies the preference being used by an experiment, we need to immediately remove them from the experiment and tell telemetry to stop sending data from that user.</p>\n<p>There's actually a problem with the spec here, in that if the user modifies the test preference before recipes are executed (internet issues, or just doing it before the 5-minute delay after startup), then nothing will be monitoring the preference and they could be sending telemetry data with them in the experiment but with the wrong preference value. That might be edgy-enough of an edge case that we don't care, though.</p>", "id": 284603162, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/589"}