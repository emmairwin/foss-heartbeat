{"original_position": 116, "diff_hunk": "@@ -268,34 +271,24 @@ def data(self):\n \n     @property\n     def filter_expression(self):\n-        exp = ''\n+        parts = []\n \n         if self.locales.count():\n             locales = ', '.join([\"'{}'\".format(l.code) for l in self.locales.all()])\n-            exp = 'normandy.locale in [{}]'.format(locales)\n+            parts.append('normandy.locale in [{}]'.format(locales))\n \n         if self.countries.count():\n             countries = ', '.join([\"'{}'\".format(c.code) for c in self.countries.all()])\n-\n-            if len(exp):\n-                exp += ' && '\n-\n-            exp += 'normandy.country in [{}]'.format(countries)\n+            parts.append('normandy.country in [{}]'.format(countries))\n \n         if self.channels.count():\n             channels = ', '.join([\"'{}'\".format(c.slug) for c in self.channels.all()])\n-\n-            if len(exp):\n-                exp += ' && '\n-\n-            exp += 'normandy.channel in [{}]'.format(channels)\n+            parts.append('normandy.channel in [{}]'.format(channels))\n \n         if self.extra_filter_expression:\n-            prefix = ' && (' if len(exp) else ''\n-            suffix = ')' if len(exp) else ''\n-            exp += '{}{}{}'.format(prefix, self.extra_filter_expression, suffix)\n+            parts.append(self.extra_filter_expression)\n \n-        return exp\n+        return ' && '.join(parts)", "body_text": "sure.\nFYI, as discussed i'll have to write an additional data migration to rehash the revisions", "in_reply_to_id": 96920502, "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/423", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/96928259", "created_at": "2017-01-19T18:45:47Z", "author_association": "MEMBER", "body": "sure.\r\n\r\nFYI, as discussed i'll have to write an additional data migration to rehash the revisions", "updated_at": "2017-01-19T20:27:47Z", "html_url": "https://github.com/mozilla/normandy/pull/423#discussion_r96928259", "pull_request_review_id": 17527306, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/96928259"}, "html": {"href": "https://github.com/mozilla/normandy/pull/423#discussion_r96928259"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/423"}}, "commit_id": "6823a75d26306dce045e72699d83525c891829ae", "user": {"following_url": "https://api.github.com/users/rehandalal/following{/other_user}", "events_url": "https://api.github.com/users/rehandalal/events{/privacy}", "organizations_url": "https://api.github.com/users/rehandalal/orgs", "url": "https://api.github.com/users/rehandalal", "gists_url": "https://api.github.com/users/rehandalal/gists{/gist_id}", "html_url": "https://github.com/rehandalal", "subscriptions_url": "https://api.github.com/users/rehandalal/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/987136?v=4", "repos_url": "https://api.github.com/users/rehandalal/repos", "received_events_url": "https://api.github.com/users/rehandalal/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/rehandalal/starred{/owner}{/repo}", "site_admin": false, "login": "rehandalal", "type": "User", "id": 987136, "followers_url": "https://api.github.com/users/rehandalal/followers"}, "position": null, "path": "normandy/recipes/models.py", "body_html": "<p>sure.</p>\n<p>FYI, as discussed i'll have to write an additional data migration to rehash the revisions</p>", "original_commit_id": "df4209ac3b77f82945342821b761b15ebb970f72", "id": 96928259}