{"original_position": 28, "diff_hunk": "@@ -163,6 +163,32 @@ This section describes the transforms available to filter expressions, and what\n they do. They're documented as functions, and the first parameter to each\n function is the value being transformed.\n \n+.. js:function:: stableSample(input, rate)\n+\n+   Randomly returns ``true`` or ``false`` based on the given sample rate. Used\n+   to sample over the set of matched users.\n+\n+   Sampling with this transform is stable over the input, meaning that the same\n+   input and sample rate will always result in the same return value. The most\n+   common use is to pass in a unique user ID and a recipe ID as the input; this\n+   means that each user will consistently run or not run a recipe.\n+\n+   Without stable sampling, a user might execute a recipe on Monday, and then\n+   not execute it on Tuesday. In addition, without stable sampling, a recipe\n+   would be seen by a different percentage of users each day, and over time this\n+   would add up such that the recipe is seen by more than the percent sampled.\n+\n+   :param input:\n+      A value for the sample to be stable over.\n+   :param number rate:\n+      A number between ``0`` and ``1`` with the sample rate. For example,\n+      ``0.5`` would be a 50% sample rate.\n+\n+   .. code-block:: javascript\n+\n+      // True 50% of the time, stable per-user per-recipe.\n+      (normandy.userId + normandy.recipe.id)|stableSample(0.5)", "body_text": "I was expecting [normandy.userId, normandy.recipe.id]|stableSample(0.5). Not that it would really be much different in JS.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/194", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/70845195", "created_at": "2016-07-14T17:16:46Z", "author_association": "MEMBER", "body": "I was expecting `[normandy.userId, normandy.recipe.id]|stableSample(0.5)`. Not that it would really be much different in JS.\n", "updated_at": "2016-07-14T17:17:45Z", "html_url": "https://github.com/mozilla/normandy/pull/194#discussion_r70845195", "pull_request_review_id": null, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/70845195"}, "html": {"href": "https://github.com/mozilla/normandy/pull/194#discussion_r70845195"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/194"}}, "commit_id": "f92a4dbaad17aac0e7436f11f659b847aba54fe6", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "docs/user/filter_expressions.rst", "body_html": "<p>I was expecting <code>[normandy.userId, normandy.recipe.id]|stableSample(0.5)</code>. Not that it would really be much different in JS.</p>", "original_commit_id": "89baa05ccc4d342812b608b266600d7023ae52c9", "id": 70845195}