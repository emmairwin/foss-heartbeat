{"original_position": 22, "diff_hunk": "@@ -488,6 +488,46 @@ def test_list_filter_text(self, api_client):\n         for recipe in res.data:\n             assert recipe['id'] in [r1.id, r2.id]\n \n+    def test_update_recipe_action(self, api_client):\n+        r = RecipeFactory()\n+        a = ActionFactory(name='test')\n+\n+        res = api_client.patch(f'/api/v1/recipe/{r.pk}/', {'action': 'test'})\n+        assert res.status_code == 200\n+\n+        r.refresh_from_db()\n+        assert r.action == a\n+\n+    def test_update_recipe_locale(self, api_client):\n+        r = RecipeFactory()\n+        l = LocaleFactory(code='en-US')\n+\n+        res = api_client.patch(f'/api/v1/recipe/{r.pk}/', {'locales': ['en-US']})\n+        assert res.status_code == 200\n+\n+        r.refresh_from_db()\n+        assert r.locales.filter(pk=l.pk).exists()", "body_text": "Could we assert against a list of locales instead of just checking if the one exists? As it is this will pass if other countries remain in the locale list, which isn't what we want, I think.\nMight even want to set up another locale as already assigned to the recipe, to be sure that it's removing the old locales as well as adding the new ones.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/671", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/110480250", "created_at": "2017-04-07T20:50:55Z", "author_association": "MEMBER", "body": "Could we assert against a list of locales instead of just checking if the one exists? As it is this will pass if other countries remain in the locale list, which isn't what we want, I think.\r\n\r\nMight even want to set up another locale as already assigned to the recipe, to be sure that it's removing the old locales as well as adding the new ones.", "updated_at": "2017-04-07T21:10:41Z", "html_url": "https://github.com/mozilla/normandy/pull/671#discussion_r110480250", "pull_request_review_id": 31660811, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/110480250"}, "html": {"href": "https://github.com/mozilla/normandy/pull/671#discussion_r110480250"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/671"}}, "commit_id": "748ff43303b1618c7aead77308ba057c16c486d9", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "recipe-server/normandy/recipes/tests/test_api.py", "body_html": "<p>Could we assert against a list of locales instead of just checking if the one exists? As it is this will pass if other countries remain in the locale list, which isn't what we want, I think.</p>\n<p>Might even want to set up another locale as already assigned to the recipe, to be sure that it's removing the old locales as well as adding the new ones.</p>", "original_commit_id": "3a08499116284610f6b0f81f001b39e859be59db", "id": 110480250}