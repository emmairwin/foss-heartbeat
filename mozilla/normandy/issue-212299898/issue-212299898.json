{"body_text": "We're working on a spec with the Telemetry folks about how to notify Telemetry when a user is participating in an experiment. Since we will have several actions that enroll users in experiments, we need an API for triggering the calls to Telemetry.\nThe (rather terse) working spec for this API:\n\nnormandy.preferenceExperiments.start(experimentName, experimentBranch, preferenceName, experimentalValue)\n\nSave the old value of the preference.\nChange the preference to the new value.\nRegister a watcher for the preference that stops the experiment if it's changed\n\n\nnormandy.preferenceExperiments.bump(experimentName)\n\nUpdate the last-seen date for the experiment.\n\n\nnormandy.preferenceExperiments.stop(experimentName)\n\nReset the preference to its previous value.\nRemove the preference watcher.\nInform telemetry that the experiment has ended.\n\n\nnormandy.preferenceExperiments.getAllActive()\nnormandy.preferenceExperiments.getAllEnded()\n\nOn startup, the system add-on should:\n\nFor each active preference experiment\n\nIf the preference in question has changed, remove the user from the experiment.\nRegister a preference watcher to remove the user if the preference changes.\nInform telemetry of the experiment.\n\n\n\nOnce a day, the add-on should check for active experiments that have not been bumped in 30 days, and remove the user from them.\nThis is kinda blocked on getting the final API from telemetry, and on them landing that in Firefox.", "labels": [], "number": 592, "assignee": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "repository_url": "https://api.github.com/repos/mozilla/normandy", "closed_at": "2017-03-28T22:28:51Z", "body_html": "<p>We're working <a href=\"https://docs.google.com/a/mozilla.com/document/d/14KCOdvvZjKkzW3LBJSY5CX7ixBzRbTao0jJ-rLNn--o/edit?usp=sharing\" rel=\"nofollow\">on a spec</a> with the Telemetry folks about how to notify Telemetry when a user is participating in an experiment. Since we will have several actions that enroll users in experiments, we need an API for triggering the calls to Telemetry.</p>\n<p>The (rather terse) working spec for this API:</p>\n<ul>\n<li>normandy.preferenceExperiments.start(experimentName, experimentBranch, preferenceName, experimentalValue)\n<ul>\n<li>Save the old value of the preference.</li>\n<li>Change the preference to the new value.</li>\n<li>Register a watcher for the preference that stops the experiment if it's changed</li>\n</ul>\n</li>\n<li>normandy.preferenceExperiments.bump(experimentName)\n<ul>\n<li>Update the last-seen date for the experiment.</li>\n</ul>\n</li>\n<li>normandy.preferenceExperiments.stop(experimentName)\n<ul>\n<li>Reset the preference to its previous value.</li>\n<li>Remove the preference watcher.</li>\n<li>Inform telemetry that the experiment has ended.</li>\n</ul>\n</li>\n<li>normandy.preferenceExperiments.getAllActive()</li>\n<li>normandy.preferenceExperiments.getAllEnded()</li>\n</ul>\n<p>On startup, the system add-on should:</p>\n<ul>\n<li>For each active preference experiment\n<ul>\n<li>If the preference in question has changed, remove the user from the experiment.</li>\n<li>Register a preference watcher to remove the user if the preference changes.</li>\n<li>Inform telemetry of the experiment.</li>\n</ul>\n</li>\n</ul>\n<p>Once a day, the add-on should check for active experiments that have not been bumped in 30 days, and remove the user from them.</p>\n<p>This is kinda blocked on getting the final API from telemetry, and on them landing that in Firefox.</p>", "id": 212299898, "title": "Driver API for preference experiments", "comments": 1, "state": "closed", "body": "We're working [on a spec](https://docs.google.com/a/mozilla.com/document/d/14KCOdvvZjKkzW3LBJSY5CX7ixBzRbTao0jJ-rLNn--o/edit?usp=sharing) with the Telemetry folks about how to notify Telemetry when a user is participating in an experiment. Since we will have several actions that enroll users in experiments, we need an API for triggering the calls to Telemetry.\r\n\r\nThe (rather terse) working spec for this API:\r\n\r\n- normandy.preferenceExperiments.start(experimentName, experimentBranch, preferenceName, experimentalValue)\r\n  - Save the old value of the preference.\r\n  - Change the preference to the new value.\r\n  - Register a watcher for the preference that stops the experiment if it's changed\r\n- normandy.preferenceExperiments.bump(experimentName)\r\n  - Update the last-seen date for the experiment.\r\n- normandy.preferenceExperiments.stop(experimentName)\r\n  - Reset the preference to its previous value.\r\n  - Remove the preference watcher.\r\n  - Inform telemetry that the experiment has ended.\r\n- normandy.preferenceExperiments.getAllActive()\r\n- normandy.preferenceExperiments.getAllEnded()\r\n\r\nOn startup, the system add-on should:\r\n- For each active preference experiment\r\n  - If the preference in question has changed, remove the user from the experiment.\r\n  - Register a preference watcher to remove the user if the preference changes.\r\n  - Inform telemetry of the experiment.\r\n\r\nOnce a day, the add-on should check for active experiments that have not been bumped in 30 days, and remove the user from them.\r\n\r\nThis is kinda blocked on getting the final API from telemetry, and on them landing that in Firefox.\r\n", "events_url": "https://api.github.com/repos/mozilla/normandy/issues/592/events", "labels_url": "https://api.github.com/repos/mozilla/normandy/issues/592/labels{/name}", "author_association": "MEMBER", "comments_url": "https://api.github.com/repos/mozilla/normandy/issues/592/comments", "html_url": "https://github.com/mozilla/normandy/issues/592", "updated_at": "2018-01-30T17:40:32Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "milestone": null, "locked": false, "url": "https://api.github.com/repos/mozilla/normandy/issues/592", "created_at": "2017-03-07T01:08:48Z", "assignees": [{"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}]}