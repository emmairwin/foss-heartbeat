{"original_position": 23, "diff_hunk": "@@ -0,0 +1,31 @@\n+from django import template\n+from django.utils.safestring import mark_safe\n+\n+from webpack_loader.templatetags.webpack_loader import get_files\n+\n+from normandy.base.utils import sri_hash\n+\n+\n+register = template.Library()\n+\n+\n+@register.simple_tag\n+def render_bundle(bundle_name, extension=None, config='DEFAULT', attrs=''):\n+    \"\"\"\n+    Modified version of webpack_loader's render_bundle that adds hashes\n+    to tags for subresource integrity.\n+    \"\"\"\n+    tags = []\n+    chunks = get_files(bundle_name, extension=extension, config=config)\n+    for chunk in chunks:\n+        with open(chunk['path'], 'rb') as f:\n+            chunk_hash = sri_hash(f.read())\n+        if chunk['name'].endswith(('.js', '.js.gz')):", "body_text": "I don't think we actually use .js.gz files, do we? That sounds like something we shouldn't do. I'd be fine if the extra bit wasn't here.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/511", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/100928367", "created_at": "2017-02-13T23:45:52Z", "author_association": "MEMBER", "body": "I don't think we actually use `.js.gz` files, do we? That sounds like something we shouldn't do. I'd be fine if the extra bit wasn't here.", "updated_at": "2017-03-01T04:25:09Z", "html_url": "https://github.com/mozilla/normandy/pull/511#discussion_r100928367", "pull_request_review_id": 21644488, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/100928367"}, "html": {"href": "https://github.com/mozilla/normandy/pull/511#discussion_r100928367"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/511"}}, "commit_id": "c5c692270b79fec4d334f8154b237826011b9307", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "recipe-server/normandy/base/templatetags/normandy_webpack_loader.py", "body_html": "<p>I don't think we actually use <code>.js.gz</code> files, do we? That sounds like something we shouldn't do. I'd be fine if the extra bit wasn't here.</p>", "original_commit_id": "af6cb1eb663c174f8cfac0fcf6761f1d8014d21b", "id": 100928367}