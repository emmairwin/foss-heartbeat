{"original_position": 49, "diff_hunk": "@@ -19,55 +17,41 @@ const BASE_API_URL = '/api/v1/recipe/';\n const API_REQUEST_SETTINGS = {\n   credentials: 'include',\n   headers: {\n-    'X-CSRFToken': document.getElementsByTagName('html')[0].dataset.csrf\n+    'X-CSRFToken': document.getElementsByTagName('html')[0].dataset.csrf,\n+    'Accept': 'application/json',\n+    'Content-Type': 'application/json'\n   }\n };\n \n const apiRequestMap = {\n   fetchAllRecipes(settings, getState) {\n-    if (shouldFetchRecipes(getState())) {\n-      return {\n-        url: BASE_API_URL,\n-        settings: {\n-          method: 'get'\n-        },\n-        actionOnSuccess: recipesReceived,\n-        errorNotification: 'Error fetching recipes.'\n-      };\n-    } else {\n-      return null;\n-    }\n-  },\n-\n-  fetchSingleRecipe(recipeInfo) {\n     return {\n-      url: `${BASE_API_URL}${recipeInfo.recipeId}/`,\n+      url: BASE_API_URL,\n       settings: {\n-        method: 'get'\n+        method: 'GET'\n       },\n-      actionOnSuccess: singleRecipeReceived,\n-      errorNotification: 'Error fetching recipe.'\n+      errorNotification: 'Error fetching recipes.'\n     };\n   },\n \n-  fetchSingleRevision(recipeInfo) {\n+  fetchSingleRecipe(recipeInfo) {\n+    let fetchUrl = (recipeInfo.recipeId ? `${BASE_API_URL}${recipeInfo.recipeId}/` : `/api/v1/recipe_version/${recipeInfo.revisionId}/`)", "body_text": "it's weird to only use BASE_API_URL in one spot and a full URL in another. Also BASE_API_URL isn't actually the base API url, it's just the URL to the recipe API itself.\nAlso why is fetchSingleRecipe handling fetching two different types of objects?", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/171", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/68299786", "created_at": "2016-06-23T19:31:57Z", "author_association": "MEMBER", "body": "it's weird to only use `BASE_API_URL` in one spot and a full URL in another. Also `BASE_API_URL` isn't actually the base API url, it's just the URL to the recipe API itself.\n\nAlso why is `fetchSingleRecipe` handling fetching two different types of objects?\n", "updated_at": "2016-06-29T19:03:17Z", "html_url": "https://github.com/mozilla/normandy/pull/171#discussion_r68299786", "pull_request_review_id": null, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/68299786"}, "html": {"href": "https://github.com/mozilla/normandy/pull/171#discussion_r68299786"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/171"}}, "commit_id": "eccf53d0106764be093f2baebd03f9dd2896165f", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "normandy/control/static/control/js/actions/ControlActions.js", "body_html": "<p>it's weird to only use <code>BASE_API_URL</code> in one spot and a full URL in another. Also <code>BASE_API_URL</code> isn't actually the base API url, it's just the URL to the recipe API itself.</p>\n<p>Also why is <code>fetchSingleRecipe</code> handling fetching two different types of objects?</p>", "original_commit_id": "e0953fd4f1bbdd71eaf1f941bac4f51ba4253807", "id": 68299786}