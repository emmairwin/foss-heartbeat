{"original_position": 34, "diff_hunk": "@@ -38,23 +38,30 @@ function history(state = new Map(), action) {\n   }\n }\n \n+const formatRecipe = recipe =>\n+  recipe\n+    .set('action_id', recipe.getIn(['action', 'id'], null))\n+    .set('latest_revision_id', recipe.getIn(['latest_revision', 'id'], null))\n+    .set('approved_revision_id', recipe.getIn(['approved_revision', 'id'], null))\n+    .remove('action')\n+    .remove('latest_revision')\n+    .remove('approved_revision');\n \n function items(state = new Map(), action) {\n-  let recipe;\n-\n   switch (action.type) {\n     case RECIPE_RECEIVE: {\n-      recipe = fromJS(action.recipe);\n+      const recipe = fromJS(action.recipe);\n+      return state.set(action.recipe.id, formatRecipe(recipe));\n+    }\n \n-      recipe = recipe\n-        .set('action_id', recipe.getIn(['action', 'id'], null))\n-        .set('latest_revision_id', recipe.getIn(['latest_revision', 'id'], null))\n-        .set('approved_revision_id', recipe.getIn(['approved_revision', 'id'], null))\n-        .remove('action')\n-        .remove('latest_revision')\n-        .remove('approved_revision');\n+    case RECIPE_PAGE_RECEIVE: {\n+      const recipes = fromJS(action.recipes.results);\n \n-      return state.set(action.recipe.id, recipe);\n+      return state.withMutations(mutState => {", "body_text": "I think this is way weirder syntax. It's harder to read to me.\nI was under the impression the withMutations stuff was going to apply to the formatRecipe and formatRevision methods.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/1042", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/139513793", "created_at": "2017-09-18T19:13:26Z", "author_association": "MEMBER", "body": "I think this is way weirder syntax. It's harder to read to me.\r\n\r\nI was under the impression the `withMutations` stuff was going to apply to the `formatRecipe` and `formatRevision` methods.", "updated_at": "2017-09-20T23:45:07Z", "html_url": "https://github.com/mozilla/normandy/pull/1042#discussion_r139513793", "pull_request_review_id": 63457107, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/139513793"}, "html": {"href": "https://github.com/mozilla/normandy/pull/1042#discussion_r139513793"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/1042"}}, "commit_id": "f3e7b3506bfed1dcafe170547c418c50c328feb4", "user": {"following_url": "https://api.github.com/users/rehandalal/following{/other_user}", "events_url": "https://api.github.com/users/rehandalal/events{/privacy}", "organizations_url": "https://api.github.com/users/rehandalal/orgs", "url": "https://api.github.com/users/rehandalal", "gists_url": "https://api.github.com/users/rehandalal/gists{/gist_id}", "html_url": "https://github.com/rehandalal", "subscriptions_url": "https://api.github.com/users/rehandalal/subscriptions", "avatar_url": "https://avatars2.githubusercontent.com/u/987136?v=4", "repos_url": "https://api.github.com/users/rehandalal/repos", "received_events_url": "https://api.github.com/users/rehandalal/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/rehandalal/starred{/owner}{/repo}", "site_admin": false, "login": "rehandalal", "type": "User", "id": 987136, "followers_url": "https://api.github.com/users/rehandalal/followers"}, "position": null, "path": "recipe-server/client/control_new/state/app/recipes/reducers.js", "body_html": "<p>I think this is way weirder syntax. It's harder to read to me.</p>\n<p>I was under the impression the <code>withMutations</code> stuff was going to apply to the <code>formatRecipe</code> and <code>formatRevision</code> methods.</p>", "original_commit_id": "bed7b0272ea014dce98347c765b5e0eb75b3704d", "id": 139513793}