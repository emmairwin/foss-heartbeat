{"original_position": 13, "diff_hunk": "@@ -128,11 +128,11 @@ export default class ShowHeartbeatAction extends Action {\n     // A bit redundant but the action argument names shouldn't necessarily rely\n     // on the argument names showHeartbeat takes.\n     const heartbeatData = {\n-      surveyId,\n+      surveyId: `${surveyId}::${flow.id}`,", "body_text": "Ah, the UUID we want to append isn't the flow ID. The flow ID is unique per-interaction with the prompt, so the same user interacting with different surveys will have a different flow ID. We want to use the per-user ID that doesn't change so that S&I can target and correlate answers from the same users over time.\nWe want to use the userId made available to filter expressions (see the filter expression docs). The getUserId function in self_repair_runner.js can fetch it. I suspect we probably want to include it in the client info returned from driver.client() so that actions can use it.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/315", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/87277353", "created_at": "2016-11-09T21:08:44Z", "author_association": "MEMBER", "body": "Ah, the UUID we want to append isn't the flow ID. The flow ID is unique per-interaction with the prompt, so the same user interacting with different surveys will have a different flow ID. We want to use the per-user ID that doesn't change so that S&I can target and correlate answers from the same users over time.\n\nWe want to use the `userId` made available to filter expressions (see the [filter expression docs](http://normandy.readthedocs.io/en/latest/user/filter_expressions.html#normandy.userId)). The `getUserId` function in `self_repair_runner.js` can fetch it. I suspect we probably want to include it in the client info returned from `driver.client()` so that actions can use it.\n", "updated_at": "2016-11-10T21:18:15Z", "html_url": "https://github.com/mozilla/normandy/pull/315#discussion_r87277353", "pull_request_review_id": 7896502, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/87277353"}, "html": {"href": "https://github.com/mozilla/normandy/pull/315#discussion_r87277353"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/315"}}, "commit_id": "ff6342e09164162a7fe4d0dd27ba9923a3a7adbf", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "position": null, "path": "client/actions/show-heartbeat/index.js", "body_html": "<p>Ah, the UUID we want to append isn't the flow ID. The flow ID is unique per-interaction with the prompt, so the same user interacting with different surveys will have a different flow ID. We want to use the per-user ID that doesn't change so that S&amp;I can target and correlate answers from the same users over time.</p>\n<p>We want to use the <code>userId</code> made available to filter expressions (see the <a href=\"http://normandy.readthedocs.io/en/latest/user/filter_expressions.html#normandy.userId\" rel=\"nofollow\">filter expression docs</a>). The <code>getUserId</code> function in <code>self_repair_runner.js</code> can fetch it. I suspect we probably want to include it in the client info returned from <code>driver.client()</code> so that actions can use it.</p>", "original_commit_id": "a1c86f39d07f1b9d6ee14bd487f08482b156e8ee", "id": 87277353}