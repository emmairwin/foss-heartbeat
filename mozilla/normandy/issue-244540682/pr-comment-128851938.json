{"original_position": 106, "diff_hunk": "@@ -0,0 +1,139 @@\n+/* This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n+\"use strict\";\n+\n+/**\n+ * Mapping of pages displayed on the sidebar. Keys are the value used in the\n+ * URL hash to identify the current page.\n+ *\n+ * Pages will appear in the sidebar in the order they are defined here. If the\n+ * URL doesn't contain a hash, the first page will be displayed in the content area.\n+ */\n+const PAGES = new Map([\n+  [\"shieldStudies\", {\n+    name: \"Shield Studies\",\n+    component: ShieldStudies,\n+    icon: \"resource://shield-recipe-client/content/about-studies/img/shield-logo.png\",\n+  }],\n+]);\n+\n+/**\n+ * Handle basic layout and routing within about:studies.\n+ */\n+class AboutStudies extends React.Component {\n+  constructor(props) {\n+    super(props);\n+\n+    let hash = new URL(window.location).hash.slice(1);\n+    if (!PAGES.has(hash)) {\n+      hash = \"shieldStudies\";\n+    }\n+\n+    this.state = {\n+      currentPageId: hash,\n+    };\n+\n+    this.handleEvent = this.handleEvent.bind(this);\n+  }\n+\n+  componentDidMount() {\n+    window.addEventListener(\"hashchange\", this);\n+  }\n+\n+  componentWillUnmount() {\n+    window.removeEventListener(\"hashchange\", this);\n+  }\n+\n+  handleEvent(event) {\n+    const newHash = new URL(event.newURL).hash.slice(1);\n+    if (PAGES.has(newHash)) {\n+      this.setState({currentPageId: newHash});\n+    }\n+  }\n+\n+  render() {\n+    const currentPageId = this.state.currentPageId;\n+    const pageEntries = Array.from(PAGES.entries());\n+    const currentPage = PAGES.get(currentPageId);\n+\n+    return (\n+      r(\"div\", {className: \"about-studies-container\"},\n+        r(Sidebar, {},\n+          pageEntries.map(([id, page]) => (\n+            r(SidebarItem, {\n+              key: id,\n+              pageId: id,\n+              selected: id === currentPageId,\n+              page,\n+            })\n+          )),\n+        ),\n+        r(Content, {},\n+          currentPage && r(currentPage.component)\n+        ),\n+      )\n+    );\n+  }\n+}\n+\n+class Sidebar extends React.Component {\n+  render() {\n+    return r(\"ul\", {id: \"categories\"}, this.props.children);\n+  }\n+}\n+Sidebar.propTypes = {\n+  children: PropTypes.node,\n+};\n+\n+class SidebarItem extends React.Component {\n+  constructor(props) {\n+    super(props);\n+    this.handleClick = this.handleClick.bind(this);\n+  }\n+\n+  handleClick() {\n+    window.location = `#${this.props.pageId}`;\n+  }\n+\n+  render() {\n+    const { page, selected } = this.props;\n+    return (\n+      r(\"li\", {\n+        className: classnames(\"category\", {selected}),\n+        onClick: this.handleClick,\n+      },\n+        page.icon && r(\"img\", {className: \"category-icon\", src: page.icon}),", "body_text": "page.icon is marked as required in the proptypes, so this shouldn't ever not render, right?", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/902", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128851938", "created_at": "2017-07-21T20:14:37Z", "author_association": "MEMBER", "body": "`page.icon` is marked as required in the proptypes, so this shouldn't ever not render, right?", "updated_at": "2017-07-27T19:03:51Z", "html_url": "https://github.com/mozilla/normandy/pull/902#discussion_r128851938", "pull_request_review_id": 51571535, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128851938"}, "html": {"href": "https://github.com/mozilla/normandy/pull/902#discussion_r128851938"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/902"}}, "commit_id": "237c17d02485073a007bad37482bf9ce3a8123e7", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": 107, "path": "recipe-client-addon/content/about-studies/about-studies.js", "body_html": "<p><code>page.icon</code> is marked as required in the proptypes, so this shouldn't ever not render, right?</p>", "original_commit_id": "7e96316c6fc1895ed5e78c0220af3f77979ba739", "id": 128851938}