{"original_position": 40, "diff_hunk": "@@ -0,0 +1,114 @@\n+/* This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n+\"use strict\";\n+\n+/**\n+ * Listen for DOM events bubbling up from the about:studies page, and perform\n+ * privileged actions in response to them. If we need to do anything that the\n+ * content process can't handle (such as reading IndexedDB), we send a message\n+ * to the parent process and handle it there.\n+ *\n+ * This file is loaded as a frame script. It will be loaded once per tab that\n+ * is opened.\n+ */\n+\n+/* global content addMessageListener removeMessageListener sendAsyncMessage */\n+\n+const { utils: Cu } = Components;\n+Cu.import(\"resource://gre/modules/XPCOMUtils.jsm\");\n+\n+XPCOMUtils.defineLazyModuleGetter(\n+  this, \"AboutPages\", \"resource://shield-recipe-client/content/AboutPages.jsm\",\n+);\n+\n+/**\n+ * Handles incoming events from the parent process and about:studies.\n+ * @implements nsIMessageListener\n+ * @implements EventListener\n+ */\n+class ShieldFrameListener {\n+  handleEvent(event) {\n+    // Abort if the current page isn't about:studies.\n+    if (!this.ensureTrustedOrigin()) {\n+      return;\n+    }\n+\n+    // Delay registering message listeners until after we've received an event\n+    // from about:studies to save resources for tabs that don't ever load it.\n+    addMessageListener(\"Shield:ShuttingDown\", this);\n+    addMessageListener(\"Shield:ReceiveStudyList\", this);", "body_text": "The wording of this comment made me think that the next two lines would somehow do something later. Maybe reword the comment to make it clear that now is the delayed time?", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/902", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128849249", "created_at": "2017-07-21T19:59:20Z", "author_association": "MEMBER", "body": "The wording of this comment made me think that the next two lines would somehow do something later. Maybe reword the comment to make it clear that *now* is the delayed time?", "updated_at": "2017-07-27T19:03:51Z", "html_url": "https://github.com/mozilla/normandy/pull/902#discussion_r128849249", "pull_request_review_id": 51571535, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128849249"}, "html": {"href": "https://github.com/mozilla/normandy/pull/902#discussion_r128849249"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/902"}}, "commit_id": "237c17d02485073a007bad37482bf9ce3a8123e7", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "recipe-client-addon/content/shield-content-frame.js", "body_html": "<p>The wording of this comment made me think that the next two lines would somehow do something later. Maybe reword the comment to make it clear that <em>now</em> is the delayed time?</p>", "original_commit_id": "0443495dd2f06517a842d6707bfeca9b75e3026e", "id": 128849249}