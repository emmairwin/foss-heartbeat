{"original_position": 130, "diff_hunk": "@@ -0,0 +1,150 @@\n+import { Button, Modal } from 'antd';\n+import autobind from 'autobind-decorator';\n+import { Map } from 'immutable';\n+import PropTypes from 'prop-types';\n+import React from 'react';\n+import { connect } from 'react-redux';\n+import { Link } from 'redux-little-router';\n+\n+import * as recipeActions from 'control_new/state/recipes/actions';\n+import * as revisionActions from 'control_new/state/revisions/actions';\n+import {\n+  getLatestRevisionIdForRecipe,\n+  getRecipe,\n+} from 'control_new/state/recipes/selectors';\n+import {\n+  isApprovableRevision,\n+  isLatestApprovedRevision,\n+  isLatestRevision,\n+  isRevisionPendingApproval,\n+} from 'control_new/state/revisions/selectors';\n+import {\n+  getUrlParam,\n+  getUrlParamAsInt,\n+} from 'control_new/state/router/selectors';\n+\n+\n+@connect(\n+  state => {\n+    const recipeId = getUrlParamAsInt(state, 'recipeId');\n+    const latestRevisionId = getLatestRevisionIdForRecipe(state, recipeId, '');\n+    const recipe = getRecipe(state, recipeId, new Map());\n+    const revisionId = getUrlParam(state, 'revisionId', latestRevisionId);\n+\n+    return {\n+      isLatest: isLatestRevision(state, revisionId),\n+      isLatestApproved: isLatestApprovedRevision(state, revisionId),\n+      isPendingApproval: isRevisionPendingApproval(state, revisionId),\n+      isApprovable: isApprovableRevision(state, revisionId),\n+      recipe,\n+      recipeId,\n+      revisionId,\n+    };\n+  },\n+  {\n+    disableRecipe: recipeActions.disableRecipe,\n+    enableRecipe: recipeActions.enableRecipe,\n+    requestRevisionApproval: revisionActions.requestRevisionApproval,\n+  },\n+)\n+@autobind\n+export default class DetailsActionBar extends React.Component {\n+  static propTypes = {\n+    disableRecipe: PropTypes.func.isRequired,\n+    enableRecipe: PropTypes.func.isRequired,\n+    isApprovable: PropTypes.bool.isRequired,\n+    isLatest: PropTypes.bool.isRequired,\n+    isLatestApproved: PropTypes.bool.isRequired,\n+    isPendingApproval: PropTypes.bool.isRequired,\n+    recipe: PropTypes.object.isRequired,\n+    recipeId: PropTypes.number.isRequired,\n+    requestRevisionApproval: PropTypes.func.isRequired,\n+    revisionId: PropTypes.string.isRequired,\n+  };\n+\n+  handleDisableClick() {\n+    const { disableRecipe, recipeId } = this.props;\n+    Modal.confirm({\n+      title: 'Are you sure you want to disable this recipe?',\n+      onOk() {\n+        disableRecipe(recipeId);\n+      },\n+    });\n+  }\n+\n+  handlePublishClick() {\n+    const { enableRecipe, recipeId } = this.props;\n+    Modal.confirm({\n+      title: 'Are you sure you want to publish this recipe?',\n+      onOk() {\n+        enableRecipe(recipeId);\n+      },\n+    });\n+  }\n+\n+  handleRequestClick() {\n+    const { requestRevisionApproval, revisionId } = this.props;\n+    requestRevisionApproval(revisionId);\n+  }\n+\n+  render() {\n+    const {\n+      isApprovable,\n+      isLatest,\n+      isLatestApproved,\n+      isPendingApproval,\n+      recipe,\n+      recipeId,\n+      revisionId,\n+    } = this.props;\n+\n+    let cloneUrl = `/recipe/${recipeId}`;\n+    if (revisionId) {\n+      cloneUrl += `/rev/${revisionId}`;\n+    }\n+    cloneUrl += '/clone';\n+\n+    return (\n+      <div className=\"details-action-bar clearfix\">\n+        <Link href={cloneUrl}>\n+          <Button icon=\"swap\" type=\"primary\">Clone</Button>\n+        </Link>\n+\n+        {\n+          isLatest &&\n+            <Link href={`/recipe/${recipeId}/edit`}>\n+              <Button icon=\"edit\" type=\"primary\">Edit</Button>\n+            </Link>\n+        }\n+\n+        {\n+          isApprovable &&\n+            <Button icon=\"question-circle\" type=\"primary\" onClick={this.handleRequestClick}>\n+              Request Approval\n+            </Button>\n+        }\n+\n+        {\n+          isPendingApproval &&\n+            <Link href={`/recipe/${recipeId}/approval_history`}>\n+              <Button icon=\"message\" type=\"primary\">Approval Request</Button>", "body_text": "Fair point re: animated icon, though I still think the treatment of the pending approval state needs a bit more prominence. As it stands, the only visual cue we're giving to the user that the recipe is pending approval is the Pending Approval text in the Timeline, and a 12x12 icon in a button.\nI think we can do more to visually signify \"hey this recipe is pending approval and this button can help you wrap it up.\" Maybe use an Alert near the top of the content, and drop a button in there with some text?", "in_reply_to_id": 128063320, "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/858", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128295378", "created_at": "2017-07-19T16:17:33Z", "author_association": "CONTRIBUTOR", "body": "Fair point re: animated icon, though I still think the treatment of the `pending approval` state needs a bit more prominence. As it stands, the only visual cue we're giving to the user that the recipe is pending approval is the `Pending Approval` text in the Timeline, and a 12x12 icon in a button.\r\n\r\nI think we can do more to visually signify \"hey this recipe is pending approval and this button can help you wrap it up.\" Maybe use an [Alert](https://ant.design/components/alert/) near the top of the content, and drop a button in there with some text?", "updated_at": "2017-07-19T17:27:53Z", "html_url": "https://github.com/mozilla/normandy/pull/858#discussion_r128295378", "pull_request_review_id": 50961894, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/128295378"}, "html": {"href": "https://github.com/mozilla/normandy/pull/858#discussion_r128295378"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/858"}}, "commit_id": "a01fcec3e56173c666db8178da1bee6718534598", "user": {"following_url": "https://api.github.com/users/andymikulski/following{/other_user}", "events_url": "https://api.github.com/users/andymikulski/events{/privacy}", "organizations_url": "https://api.github.com/users/andymikulski/orgs", "url": "https://api.github.com/users/andymikulski", "gists_url": "https://api.github.com/users/andymikulski/gists{/gist_id}", "html_url": "https://github.com/andymikulski", "subscriptions_url": "https://api.github.com/users/andymikulski/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/2767162?v=4", "repos_url": "https://api.github.com/users/andymikulski/repos", "received_events_url": "https://api.github.com/users/andymikulski/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/andymikulski/starred{/owner}{/repo}", "site_admin": false, "login": "andymikulski", "type": "User", "id": 2767162, "followers_url": "https://api.github.com/users/andymikulski/followers"}, "position": 127, "path": "recipe-server/client/control_new/components/recipes/DetailsActionBar.js", "body_html": "<p>Fair point re: animated icon, though I still think the treatment of the <code>pending approval</code> state needs a bit more prominence. As it stands, the only visual cue we're giving to the user that the recipe is pending approval is the <code>Pending Approval</code> text in the Timeline, and a 12x12 icon in a button.</p>\n<p>I think we can do more to visually signify \"hey this recipe is pending approval and this button can help you wrap it up.\" Maybe use an <a href=\"https://ant.design/components/alert/\" rel=\"nofollow\">Alert</a> near the top of the content, and drop a button in there with some text?</p>", "original_commit_id": "c30aa6f9ddb808845a2de34640fee9fa4cdd5c94", "id": 128295378}