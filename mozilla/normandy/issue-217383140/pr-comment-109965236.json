{"original_position": 30, "diff_hunk": "@@ -4,26 +4,33 @@\n \n \"use strict\";\n \n-const {utils: Cu} = Components;\n+const {utils: Cu, classes: Cc, interfaces: Ci} = Components;\n Cu.import(\"resource://gre/modules/Services.jsm\");\n-Cu.import(\"resource://gre/modules/Timer.jsm\"); /* globals setTimeout */\n Cu.import(\"resource://shield-recipe-client/lib/LogManager.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/NormandyDriver.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/FilterExpressions.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/NormandyApi.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/SandboxManager.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/Storage.jsm\");\n Cu.import(\"resource://shield-recipe-client/lib/ClientEnvironment.jsm\");\n+Cu.import(\"resource://shield-recipe-client/lib/CleanupManager.jsm\");\n Cu.import(\"resource://gre/modules/XPCOMUtils.jsm\");\n Cu.importGlobalProperties([\"fetch\"]); /* globals fetch */\n \n XPCOMUtils.defineLazyModuleGetter(this, \"Preferences\", \"resource://gre/modules/Preferences.jsm\");\n-XPCOMUtils.defineLazyModuleGetter(this, \"Storage\", \"resource://shield-recipe-client/lib/Storage.jsm\");\n+XPCOMUtils.defineLazyModuleGetter(this, \"Storage\",\n+                                  \"resource://shield-recipe-client/lib/Storage.jsm\");\n+XPCOMUtils.defineLazyServiceGetter(this, \"timerManager\",\n+                                   \"@mozilla.org/updates/timer-manager;1\",\n+                                   \"nsIUpdateTimerManager\");\n \n this.EXPORTED_SYMBOLS = [\"RecipeRunner\"];\n \n+const PREF_BASE_NAME = \"extensions.shield-recipe-client.\";\n+const PREF_RUN_INTERVAL = PREF_BASE_NAME + \"run_interval_seconds\";", "body_text": "I didn't know about prefs.addObserver(). That's convenient for us.", "in_reply_to_id": 109802987, "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/641", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/109965236", "created_at": "2017-04-05T16:33:23Z", "author_association": "MEMBER", "body": "I didn't know about `prefs.addObserver()`. That's convenient for us.", "updated_at": "2017-04-12T17:14:33Z", "html_url": "https://github.com/mozilla/normandy/pull/641#discussion_r109965236", "pull_request_review_id": 31102207, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/109965236"}, "html": {"href": "https://github.com/mozilla/normandy/pull/641#discussion_r109965236"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/641"}}, "commit_id": "03a7b3e238d9a956b4deb74246b94e438e3fb490", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": null, "path": "recipe-client-addon/lib/RecipeRunner.jsm", "body_html": "<p>I didn't know about <code>prefs.addObserver()</code>. That's convenient for us.</p>", "original_commit_id": "f359d55b1cef344b577b92b67f5d326d83d4ca4c", "id": 109965236}