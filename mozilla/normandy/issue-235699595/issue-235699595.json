{"body_text": "If the signature check for recipes fails, RecipeRunner fails to run the post-execution hooks for each action. We should probably make sure that actions have a chance to clean up after themselves in the case of a recipe signature failure, or we should decide to not run anything if the recipe signatures fail. I'm not entirely sure which of the two we should choose, but I'm leaning towards not running them at all, as a signature failure should be treated IMO as a failure to reach the server at all, vs the server explicitly saying that there are no recipes to run.\nCurrently, the only action with pre- and post- execution handlers is preference experiments, and the main consequence of not running them vs running them is that, if we do run them, signature failures would cause users to be unenrolled from their active experiments. If we didn't run them, they'd remain in the experiment.", "labels": [], "number": 811, "assignee": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "repository_url": "https://api.github.com/repos/mozilla/normandy", "closed_at": "2017-06-16T23:36:37Z", "body_html": "<p>If the signature check for recipes fails, <code>RecipeRunner</code> fails to run the post-execution hooks for each action. We should probably make sure that actions have a chance to clean up after themselves in the case of a recipe signature failure, or we should decide to not run anything if the recipe signatures fail. I'm not entirely sure which of the two we should choose, but I'm leaning towards not running them at all, as a signature failure should be treated IMO as a failure to reach the server at all, vs the server explicitly saying that there are no recipes to run.</p>\n<p>Currently, the only action with pre- and post- execution handlers is preference experiments, and the main consequence of not running them vs running them is that, if we do run them, signature failures would cause users to be unenrolled from their active experiments. If we didn't run them, they'd remain in the experiment.</p>", "id": 235699595, "title": "Post-recipe-execution hooks are not run when recipe signatures are invalid", "comments": 0, "state": "closed", "body": "If the signature check for recipes fails, `RecipeRunner` fails to run the post-execution hooks for each action. We should probably make sure that actions have a chance to clean up after themselves in the case of a recipe signature failure, or we should decide to not run anything if the recipe signatures fail. I'm not entirely sure which of the two we should choose, but I'm leaning towards not running them at all, as a signature failure should be treated IMO as a failure to reach the server at all, vs the server explicitly saying that there are no recipes to run.\r\n\r\nCurrently, the only action with pre- and post- execution handlers is preference experiments, and the main consequence of not running them vs running them is that, if we do run them, signature failures would cause users to be unenrolled from their active experiments. If we didn't run them, they'd remain in the experiment.\r\n\r\n", "events_url": "https://api.github.com/repos/mozilla/normandy/issues/811/events", "labels_url": "https://api.github.com/repos/mozilla/normandy/issues/811/labels{/name}", "author_association": "MEMBER", "comments_url": "https://api.github.com/repos/mozilla/normandy/issues/811/comments", "html_url": "https://github.com/mozilla/normandy/issues/811", "updated_at": "2017-06-16T23:36:37Z", "user": {"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}, "milestone": null, "locked": false, "url": "https://api.github.com/repos/mozilla/normandy/issues/811", "created_at": "2017-06-13T21:32:54Z", "assignees": [{"following_url": "https://api.github.com/users/Osmose/following{/other_user}", "events_url": "https://api.github.com/users/Osmose/events{/privacy}", "organizations_url": "https://api.github.com/users/Osmose/orgs", "url": "https://api.github.com/users/Osmose", "gists_url": "https://api.github.com/users/Osmose/gists{/gist_id}", "html_url": "https://github.com/Osmose", "subscriptions_url": "https://api.github.com/users/Osmose/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/193106?v=4", "repos_url": "https://api.github.com/users/Osmose/repos", "received_events_url": "https://api.github.com/users/Osmose/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/Osmose/starred{/owner}{/repo}", "site_admin": false, "login": "Osmose", "type": "User", "id": 193106, "followers_url": "https://api.github.com/users/Osmose/followers"}]}