{"original_position": 158, "diff_hunk": "@@ -207,18 +211,53 @@ describe('controlApp reducer', () => {\n       ...initialState,\n       recipes: {\n         ...initialState.recipes,\n-        list: [{\n-          id: 1,\n-          name: 'Lorem Ipsum',\n+        list: {\n+          1: {\n+            id: 1,\n+            name: 'Lorem Ipsum',\n+            enabled: true,\n+          },\n+          2: {\n+            id: 2,\n+            name: 'Dolor set amet',\n+            enabled: true,\n+          },\n+        },\n+      },\n+    });\n+  });\n+\n+  describe('Recipe Creation and Updating', () => {\n+    it('only has one recipe in the `list` after creating and updating a new recipe', async () => {", "body_text": "Aight - took some playing but I figured out the issue. The bug didn't lie with updating the recipe, it was creating the recipe and then loading the recipe list. Creating a recipe stored it in memory, then loading the recipe list from the API would add just append to the list in memory, not checking against dupes.\nI had figured it out using a UI test, but in the end a reducer test was all that was really needed, so that's the test that went in. I also confirmed the test failed appropriately on master, as well.\nThis should be all set!", "in_reply_to_id": 97650332, "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/432", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/98338373", "created_at": "2017-01-28T20:09:14Z", "author_association": "CONTRIBUTOR", "body": "Aight - took some playing but I figured out the issue. The bug didn't lie with updating the recipe, it was creating the recipe and then loading the recipe list. Creating a recipe stored it in memory, then loading the recipe list from the API would add just append to the list in memory, not checking against dupes.\r\n\r\nI had figured it out using a UI test, but in the end a reducer test was all that was really needed, so that's the test that went in. I also confirmed the test failed appropriately on `master`, as well.\r\n\r\nThis should be all set!", "updated_at": "2017-01-28T20:09:14Z", "html_url": "https://github.com/mozilla/normandy/pull/432#discussion_r98338373", "pull_request_review_id": 18980170, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/98338373"}, "html": {"href": "https://github.com/mozilla/normandy/pull/432#discussion_r98338373"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/432"}}, "commit_id": "84f8452c9cc3bbbef5dff19941e0e5c668ae2471", "user": {"following_url": "https://api.github.com/users/andymikulski/following{/other_user}", "events_url": "https://api.github.com/users/andymikulski/events{/privacy}", "organizations_url": "https://api.github.com/users/andymikulski/orgs", "url": "https://api.github.com/users/andymikulski", "gists_url": "https://api.github.com/users/andymikulski/gists{/gist_id}", "html_url": "https://github.com/andymikulski", "subscriptions_url": "https://api.github.com/users/andymikulski/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/2767162?v=4", "repos_url": "https://api.github.com/users/andymikulski/repos", "received_events_url": "https://api.github.com/users/andymikulski/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/andymikulski/starred{/owner}{/repo}", "site_admin": false, "login": "andymikulski", "type": "User", "id": 2767162, "followers_url": "https://api.github.com/users/andymikulski/followers"}, "position": null, "path": "recipe-server/client/control/tests/reducers/test_controlAppReducer.js", "body_html": "<p>Aight - took some playing but I figured out the issue. The bug didn't lie with updating the recipe, it was creating the recipe and then loading the recipe list. Creating a recipe stored it in memory, then loading the recipe list from the API would add just append to the list in memory, not checking against dupes.</p>\n<p>I had figured it out using a UI test, but in the end a reducer test was all that was really needed, so that's the test that went in. I also confirmed the test failed appropriately on <code>master</code>, as well.</p>\n<p>This should be all set!</p>", "original_commit_id": "7911a76b50adfd7db761114a5813ae592711920a", "id": 98338373}