{"body": "- `PreferenceManagement` changed from being instanced by Experiments and Rollouts, to being inherited by them. The reason for this was that both modules needed the similar pref API, however Rollouts needed direct access to the `store` in PrefMan. Inheriting PrefMan's logic instead lets Rollouts access what it needs to without manually exposing the store, and nothing really changes in Experiments.\r\n  - This also cleaned up some of the exports in `NormandyDriver`\r\n- A majority of the `PreferenceExperiment` tests were split into a PrefMan-specific suite.\r\n- There is still a test failing - for some reason, a function is losing context (`\"this\" is undefined`), even though the function that's being called is already being bound. I'm pretty sure @Osmose ran into this problem before, so I'll consult him on how to fix it.\r\n\r\n@mythmon Can you review this before I toss it to FF QA?", "body_text": "PreferenceManagement changed from being instanced by Experiments and Rollouts, to being inherited by them. The reason for this was that both modules needed the similar pref API, however Rollouts needed direct access to the store in PrefMan. Inheriting PrefMan's logic instead lets Rollouts access what it needs to without manually exposing the store, and nothing really changes in Experiments.\n\nThis also cleaned up some of the exports in NormandyDriver\n\n\nA majority of the PreferenceExperiment tests were split into a PrefMan-specific suite.\nThere is still a test failing - for some reason, a function is losing context (\"this\" is undefined), even though the function that's being called is already being bound. I'm pretty sure @Osmose ran into this problem before, so I'll consult him on how to fix it.\n\n@mythmon Can you review this before I toss it to FF QA?", "url": "https://api.github.com/repos/mozilla/normandy/issues/comments/302140211", "created_at": "2017-05-17T16:10:35Z", "author_association": "CONTRIBUTOR", "html_url": "https://github.com/mozilla/normandy/pull/724#issuecomment-302140211", "updated_at": "2017-05-17T16:10:35Z", "user": {"following_url": "https://api.github.com/users/andymikulski/following{/other_user}", "events_url": "https://api.github.com/users/andymikulski/events{/privacy}", "organizations_url": "https://api.github.com/users/andymikulski/orgs", "url": "https://api.github.com/users/andymikulski", "gists_url": "https://api.github.com/users/andymikulski/gists{/gist_id}", "html_url": "https://github.com/andymikulski", "subscriptions_url": "https://api.github.com/users/andymikulski/subscriptions", "avatar_url": "https://avatars1.githubusercontent.com/u/2767162?v=4", "repos_url": "https://api.github.com/users/andymikulski/repos", "received_events_url": "https://api.github.com/users/andymikulski/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/andymikulski/starred{/owner}{/repo}", "site_admin": false, "login": "andymikulski", "type": "User", "id": 2767162, "followers_url": "https://api.github.com/users/andymikulski/followers"}, "body_html": "<ul>\n<li><code>PreferenceManagement</code> changed from being instanced by Experiments and Rollouts, to being inherited by them. The reason for this was that both modules needed the similar pref API, however Rollouts needed direct access to the <code>store</code> in PrefMan. Inheriting PrefMan's logic instead lets Rollouts access what it needs to without manually exposing the store, and nothing really changes in Experiments.\n<ul>\n<li>This also cleaned up some of the exports in <code>NormandyDriver</code></li>\n</ul>\n</li>\n<li>A majority of the <code>PreferenceExperiment</code> tests were split into a PrefMan-specific suite.</li>\n<li>There is still a test failing - for some reason, a function is losing context (<code>\"this\" is undefined</code>), even though the function that's being called is already being bound. I'm pretty sure <a class=\"user-mention\" href=\"https://github.com/osmose\">@Osmose</a> ran into this problem before, so I'll consult him on how to fix it.</li>\n</ul>\n<p><a class=\"user-mention\" href=\"https://github.com/mythmon\">@mythmon</a> Can you review this before I toss it to FF QA?</p>", "id": 302140211, "issue_url": "https://api.github.com/repos/mozilla/normandy/issues/724"}