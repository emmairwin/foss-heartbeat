{"original_position": 154, "diff_hunk": "@@ -0,0 +1,166 @@\n+<!DOCTYPE html>\n+<html lang=\"en-us\">\n+  <head>\n+    <title>SHIELD Test Service</title>\n+    <style>\n+      * {\n+        box-sizing: border-box;\n+      }\n+\n+      body {\n+        background: #F6F4EF;\n+        color: #585755;\n+        font-family: sans-serif;\n+        font-size: 15px;\n+        line-height: 1.4em;\n+        margin: 0 auto;\n+        width: 720px;\n+        word-wrap: break-word;\n+      }\n+\n+      a {\n+        font-weight: 600;\n+        text-decoration: none;\n+      }\n+\n+      li {\n+        margin-bottom: .5em;\n+      }\n+\n+      pre, code {\n+        background: #EEE;\n+        border: 1px solid #CCC;\n+      }\n+\n+      pre {\n+        margin: 0 0 1.5em;\n+        padding: 5px;\n+      }\n+\n+      code {\n+        box-decoration-break: clone;\n+        padding: 2px 4px;\n+        position: relative;\n+        top: -1px;\n+      }\n+\n+      .testcase {\n+        background: #FFF;\n+        margin: 0 0 20px;\n+      }\n+\n+      .testcase h3 {\n+        background: #585755;\n+        color: #FFF;\n+        margin: 0;\n+        padding: 15px\n+      }\n+\n+      .testcase-content {\n+        padding: 15px;\n+      }\n+\n+      .testcase-content p {\n+        margin: 0 0 1.5em;\n+      }\n+\n+      textarea {\n+        border: 1px solid #ece7db;\n+        border-radius: 3px;\n+        display: block;\n+        height: 6em;\n+        overflow: auto;\n+        padding: 5px;\n+        white-space: pre;\n+        width: 100%;\n+      }\n+    </style>\n+  </head>\n+  <body>\n+    <h1>SHIELD Test Service</h1>\n+    <p>\n+      This service hosts the data needed for running manual tests of the\n+      <a href=\"https://wiki.mozilla.org/Firefox/SHIELD\">SHIELD</a> recipe\n+      client. The scripts that generate this page and the data are\n+      <a href=\"https://github.com/mozilla/normandy/tree/master/mock-recipe-server\">\n+      hosted on Github</a>.\n+    </p>\n+    <h2>Setting up for Testing</h2>\n+    <ol>\n+      <li>\n+        Obtain a copy of Firefox with the SHIELD recipe client system add-on\n+        installed. You can check <code>about:support</code> to ensure that you\n+        have it.\n+      </li>\n+      <li>\n+        Set the <code>extensions.shield-recipe-client.dev_mode</code> preference\n+        to <code>true</code> to run recipes immediately on startup.\n+      </li>\n+      <li>\n+        Set the <code>extensions.shield-recipe-client.logging.level</code>\n+        preference to <code>0</code> to enable more logging.\n+      </li>\n+      <li>\n+        Set the <code>security.content.signature.root_hash</code> preference to\n+        <code>4C:35:B1:C3:E3:12:D9:55:E7:78:ED:D0:A7:E7:8A:38:83:04:EF:01:BF:FA:03:29:B2:46:9F:3C:C5:EC:36:04</code>.\n+        This is the public hash used for verifying content signatures of the\n+        test data.\n+      </li>\n+    </ol>\n+    <h2>Verifying a Test Case</h2>\n+    <p>\n+      You have two options for verifying a test case depending on how thoroughly\n+      you want to test the client:\n+    </p>\n+    <ul>\n+      <li>\n+        Find the test in the list below, set the\n+        <code>extensions.shield-recipe-client.api_url</code> preference to the\n+        given URL, and restart your browser. Upon restart, the client will\n+        download recipes and execute them. This tests the recipe client from\n+        startup to recipe execution.\n+      </li>\n+      <li>\n+        If you have enabled the browser chrome debugging toolbox in the DevTools\n+        settings, you can copy and paste the code from the textbox into the\n+        Browser Console to immediately set the right preferences and fetch the\n+        recipes. This skips testing a small amount of initialization, but is\n+        otherwise a quick and reliable way of testing.\n+      </li>\n+    </ul>\n+    <h2>Test Cases</h2>\n+    {% for testcase in testcases %}\n+      <div class=\"testcase\" data-name=\"{{ testcase.name }}\">\n+        <h3>{{ testcase.name }}</h3>\n+        <div class=\"testcase-content\">\n+          {{ testcase.description|safe }}\n+          <p><strong>URL:</strong> <code class=\"url\"></code></p>\n+          <textarea class=\"browser-code\"></textarea>\n+        </div>\n+      </div>\n+    {% endfor %}\n+    <script>\n+      // Caluclate URLs relative to the current domain and populate each\n+      // testcase with them.\n+      let testcases = Array.from(document.querySelectorAll('.testcase'));\n+      for (let testcase of testcases) {\n+        let url = new URL(`/${testcase.dataset.name}/api/v1`, window.location);\n+        testcase.querySelector('.url').textContent = url.href;\n+        testcase.querySelector('.browser-code').value = (\n+          `Cu.import('resource://shield-recipe-client/lib/Storage.jsm');\\n` +\n+          `Storage.clearAllStorage();\\n` +\n+          `Services.prefs.setCharPref(\"extensions.shield-recipe-client.api_url\", \"${url.href}\");\\n` +\n+          `Cu.import('resource://shield-recipe-client/lib/RecipeRunner.jsm');\\n` +\n+          `RecipeRunner.start();`", "body_text": "On the one hand, you can do multiline strings directly with backticks. On the other hand, the indentation is super annoying, so this is probably the right thing to do.", "pull_request_url": "https://api.github.com/repos/mozilla/normandy/pulls/437", "url": "https://api.github.com/repos/mozilla/normandy/pulls/comments/99195636", "created_at": "2017-02-02T19:07:46Z", "author_association": "MEMBER", "body": "On the one hand, you can do multiline strings directly with backticks. On the other hand, the indentation is super annoying, so this is probably the right thing to do.", "updated_at": "2017-02-02T19:07:46Z", "html_url": "https://github.com/mozilla/normandy/pull/437#discussion_r99195636", "pull_request_review_id": 19865138, "_links": {"self": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/comments/99195636"}, "html": {"href": "https://github.com/mozilla/normandy/pull/437#discussion_r99195636"}, "pull_request": {"href": "https://api.github.com/repos/mozilla/normandy/pulls/437"}}, "commit_id": "d00bbfd3fa37fe81049fbe331504ff8f3b07e1e6", "user": {"following_url": "https://api.github.com/users/mythmon/following{/other_user}", "events_url": "https://api.github.com/users/mythmon/events{/privacy}", "organizations_url": "https://api.github.com/users/mythmon/orgs", "url": "https://api.github.com/users/mythmon", "gists_url": "https://api.github.com/users/mythmon/gists{/gist_id}", "html_url": "https://github.com/mythmon", "subscriptions_url": "https://api.github.com/users/mythmon/subscriptions", "avatar_url": "https://avatars3.githubusercontent.com/u/305049?v=4", "repos_url": "https://api.github.com/users/mythmon/repos", "received_events_url": "https://api.github.com/users/mythmon/received_events", "gravatar_id": "", "starred_url": "https://api.github.com/users/mythmon/starred{/owner}{/repo}", "site_admin": false, "login": "mythmon", "type": "User", "id": 305049, "followers_url": "https://api.github.com/users/mythmon/followers"}, "position": 154, "path": "mock-recipe-server/api_index.html", "body_html": "<p>On the one hand, you can do multiline strings directly with backticks. On the other hand, the indentation is super annoying, so this is probably the right thing to do.</p>", "original_commit_id": "d00bbfd3fa37fe81049fbe331504ff8f3b07e1e6", "id": 99195636}