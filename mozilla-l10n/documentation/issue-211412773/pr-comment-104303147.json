{"url": "https://api.github.com/repos/mozilla-l10n/documentation/pulls/comments/104303147", "pull_request_review_id": 25137867, "id": 104303147, "diff_hunk": "@@ -20,131 +23,129 @@ The file you need to update is [app/config/sources.inc.php](https://github.com/m\n     $mozillaorg_lang,\n     'en-US', // source locale\n     $repositories['www.mozilla.org']['public_path'],\n-    $lang_flags['www.mozilla.org'],\n+    3,\n     'lang',\n ],\n ```\n The array storing all supported files is the 5th element (`$mozillaorg_lang`). With time you won\u2019t need to check the configuration array, it will be enough to search for a similar file in the same project.\n \n-Search for the definition of `$mozillaorg_lang` and add the new file, remembering that files are usually in alphabetical order (snippets are an exception). This is how the definition\u2019s begin looks:\n+### Supported locales\n+Search for the definition of `$mozillaorg_lang` in `app/config/sources.inc.php` and add the new file, respecting the existing alphabetical order (snippets represent an exception to this rule). This is how the definition\u2019s begin looks:\n ```PHP\n $mozillaorg_lang = [\n-    'download.lang',\n-    'download_button.lang',\n-    'esr.lang',\n-    'firefox/accounts.lang',\n-    'firefox/android/index.lang',\n-    ...\n+    'download_button.lang' => [\n+        'deadline'          => '2016-04-29',\n+        'priority '         => 1,\n+        'supported_locales' => $mozillaorg,\n+    ],\n ```\n \n-Add your new file `mozorg/contribute/signup.lang`:\n+Supported locales are defined in each file as an array associated to the key `supported_locales`. If this key is missing, file will fall back to the list of locales supported for the website (project) it belongs to. For clarity it\u2019s highly suggested to always specify the list of supported locales.\n+\n+For the list of locales you should check the definition for existing similar files. In this case, you can use the same settings as another `contribute` pages:\n ```PHP\n-$mozillaorg_lang = [\n-    ...\n-    'mozorg/contribute/friends.lang',\n-    'mozorg/contribute/index.lang',\n-    'mozorg/contribute/signup.lang',\n-    'mozorg/contribute/stories.lang',\n-    'mozorg/home/index.lang',    \n-    ...\n+'mozorg/contribute/index.lang' => [\n+    'flags' => [\n+        'opt-in' => ['all'],\n+    ],\n+    'priority'          => 2,\n+    'supported_locales' => $getinvolved_locales,\n+],\n+'mozorg/contribute/signup.lang' => [\n+    'supported_locales' => $getinvolved_locales,\n+],\n ```\n \n-Now Langchecker knows that this file is supported by `www.mozilla.org`.\n+### Priority\n+Priority is optional and can defined for each file. If the priority is the same for all locales, you can assign the integer value (from 1 to 3) to a `priority` key.\n \n-## Set the flags for this file\n-This is an optional step: if a file doesn\u2019t have any flag associated, it will be considered *non critical* for all locales.\n+```PHP\n+'mozorg/contribute/index.lang' => [\n+    'priority'          => 2,\n+    'supported_locales' => $getinvolved_locales,\n+],\n+```\n+\n+It\u2019s also possible to define a more complex set of priorities using an associative array, where to each priority (a numeric key) is associated an array of locales. `all` is a special locale to represent all supported locales for this file. For example:\n \n-Flags are defined in a global array called `$lang_flags`, where a key for each project stores all flag for each file. Usually the definition of flags immedtiately follows the array with the list of supported files. In this case:\n ```PHP\n-$lang_flags['www.mozilla.org'] = [\n-    'download.lang'                           => [ 'critical' => ['all'] ],\n-    'download_button.lang'                    => [ 'critical' => ['all'] ],\n-    'firefox/accounts.lang'                   => [ 'critical' => ['all'] ],\n-    'firefox/android/index.lang'              => [\n-        'critical' => [$android_locales],\n-        'opt-in'   => ['all'],\n-    ],\n-    ...\n+'priorities'          => [\n+    1 => ['de', 'fr'],\n+    2 => ['all'],\n+],\n ```\n \n-You need to set this file as `critical` only for French and German, `opt-in` for other locales. Again, files are usually in alphabetical order:\n+If you don\u2019t specify a priority, the file will fall back to the default priority specified for the project (in `$sites`). In this case the request is to set the file with priority 1 for French and German, while the default for mozilla.org is 3.\n+\n+In this case, the request is to assign priority 1 only to French and German\n ```PHP\n-$lang_flags['www.mozilla.org'] = [\n-    'download.lang'                           => [ 'critical' => ['all'] ],\n-    'download_button.lang'                    => [ 'critical' => ['all'] ],\n-    ...\n-    'mozorg/contribute/friends.lang'          => [ 'obsolete' => ['all'] ],\n-    'mozorg/contribute/index.lang'            => [\n-        'critical' => ['all'],\n+'mozorg/contribute/signup.lang' => [\n+    'priority'          => [\n+        1 => ['de', 'fr'],\n     ],\n-    'mozorg/contribute/stories.lang'          => [\n-        'critical' => ['all'],\n-    ],    \n-    ...\n+    'supported_locales' => $getinvolved_locales,\n+],\n ```\n \n-What you need to add is this definition:\n+### Flags\n+Flag are defined for each file as an array associated to the key `flags`:\n ```PHP\n-'mozorg/contribute/signup.lang'          => [\n-    'critical' => ['de', 'fr'],\n-    'opt-in'   => ['all'],\n+'mozorg/contribute/index.lang' => [\n+    'flags' => [\n+        'opt-in' => ['all'],\n+    ],\n+    'supported_locales' => $getinvolved_locales,\n ],\n ```\n-You create a new array element using the filename as key, its value is another array. To each flag (key) is associated an array of locales. `all` is a special locale to represent all supported locales for this file.\n \n-## Set the deadline for this file\n-If a file is critical, you also want to set a deadline for it: in the last week before deadline the date will be displayed in orange on the Webdashboard, after deadline it will be displayed in red.\n+To each flag (key) is associated an array of locales. `all` is a special locale to represent all supported locales for this file. Flags currently in use are: obsolete, opt-in.\n \n-Deadlines are stored in a flat array called `$deadlines`:\n+In this case, the request is to flag the file as opt-in for all locales.\n ```PHP\n-$deadline = [\n-    'ads/ios_android_apr2016.lang'           => '2016-04-22',\n-    'android_release.lang'                   => '2016-04-30', // appstores project\n-    'apple_description_release.lang'         => '2016-03-30', // appstores project\n-    'apple_screenshots_v3.lang'              => '2016-03-25', // appstores project\n-    'description_beta_page.lang'             => '2015-09-30', // appstores project\n-    'download_button.lang'                   => '2016-04-29',\n-    ...\n+'mozorg/contribute/signup.lang' => [\n+    'flags'    => [\n+        'opt-in' => ['all'],\n+    ],\n+    'priority'          => [\n+        1 => ['de', 'fr'],\n+    ],\n+    'supported_locales' => $getinvolved_locales,\n+],\n ```\n \n-Simply add the new file and its deadline, maintaining the alphabetical order.\n+### Deadline\n+If a file is critical, you also want to set a deadline for it: in the last week before deadline the date will be displayed in orange on the Webdashboard, after deadline it will be displayed in red.\n+\n+If the deadline is the same for all locales, you can assign the date (as a string in ISO format dd-mm-yyyy) to a `deadline` key. In this case, deadline needs to be set to May 30th, 2016 (2016-05-30):\n+\n ```PHP\n-$deadline = [\n-    ...\n-    'mozorg/about.lang'                      => '2015-03-26',\n-    'mozorg/contribute/index.lang'           => '2015-08-10',\n-    'mozorg/contribute/signup.lang'          => '2016-05-30',\n-    'mozorg/contribute/stories.lang'         => '2015-08-10',\n-    'mozorg/home/index.lang'                 => '2016-03-15',\n-    ...\n+'mozorg/contribute/signup.lang' => [\n+    'deadline' => '2016-05-30',\n+    'flags'    => [\n+        'opt-in' => ['all'],\n+    ],\n+    'priority'          => [\n+        1 => ['de', 'fr'],\n+    ],\n+    'supported_locales' => $getinvolved_locales,\n+],\n ```\n \n-## Specify the list of locales supported by this file\n-If you don\u2019t specify a list of supported locales for a file, it will fallback to the list of locales supported for the website (project) it belongs to. Even in that case it\u2019s clearer to always specify the list of locales.\n-\n-Language subsets are defined in a global array called `$langfiles_subsets`, where a key for each project stores all locales for each file. For `www.mozilla.org` the definition starts as:\n+It\u2019s also possible to define different deadlines for locales using an associative array, where to each deadline (date in ISO format dd-mm-yyyy) is associated an array of locales. `all` is a special locale to represent all supported locales for this file. For example, a deadline for German and French, and a later date for other languages:", "path": "tools/webdashboards/add_new_file.md", "position": null, "original_position": 209, "commit_id": "5ead846181619cb7bd73e56a5dd12b8ee3c9bd21", "original_commit_id": "11ffc5836447b4aa7eaf665a2274fd135bcf04ff", "user": {"login": "TheoChevalier", "id": 1294206, "avatar_url": "https://avatars2.githubusercontent.com/u/1294206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheoChevalier", "html_url": "https://github.com/TheoChevalier", "followers_url": "https://api.github.com/users/TheoChevalier/followers", "following_url": "https://api.github.com/users/TheoChevalier/following{/other_user}", "gists_url": "https://api.github.com/users/TheoChevalier/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheoChevalier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheoChevalier/subscriptions", "organizations_url": "https://api.github.com/users/TheoChevalier/orgs", "repos_url": "https://api.github.com/users/TheoChevalier/repos", "events_url": "https://api.github.com/users/TheoChevalier/events{/privacy}", "received_events_url": "https://api.github.com/users/TheoChevalier/received_events", "type": "User", "site_admin": false}, "body": "Same here", "created_at": "2017-03-05T03:38:29Z", "updated_at": "2017-03-05T06:23:53Z", "html_url": "https://github.com/mozilla-l10n/documentation/pull/58#discussion_r104303147", "pull_request_url": "https://api.github.com/repos/mozilla-l10n/documentation/pulls/58", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/mozilla-l10n/documentation/pulls/comments/104303147"}, "html": {"href": "https://github.com/mozilla-l10n/documentation/pull/58#discussion_r104303147"}, "pull_request": {"href": "https://api.github.com/repos/mozilla-l10n/documentation/pulls/58"}}, "body_html": "<p>Same here</p>", "body_text": "Same here"}